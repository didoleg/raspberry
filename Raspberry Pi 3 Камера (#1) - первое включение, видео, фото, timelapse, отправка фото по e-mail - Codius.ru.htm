
<!DOCTYPE html>
<html>
<head>
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script type="text/javascript" nonce="38e823804e2d40c59a697848d41" src="//local.adguard.org?ts=1677291229635&amp;type=content-script&amp;dmn=codius.ru&amp;pth=%2Farticles%2FRaspberry_Pi_3_%25D0%259A%25D0%25B0%25D0%25BC%25D0%25B5%25D1%2580%25D0%25B0_%25D1%2587%25D0%25B0%25D1%2581%25D1%2582%25D1%258C_1&amp;app=firefox.exe&amp;css=3&amp;js=1&amp;rel=1&amp;rji=1&amp;sbe=1&amp;stealth=1&amp;uag="></script>
<script type="text/javascript" nonce="38e823804e2d40c59a697848d41" src="//local.adguard.org?ts=1677291229635&amp;name=AdGuard%20Assistant&amp;name=AdGuard%20Extra&amp;name=AdGuard%20Popup%20Blocker&amp;type=user-script"></script>
    <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments)};
          gtag('js', new Date());

          gtag('config', 'UA-106530627-1');
    </script>
    <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-106530627-1', 'auto');
          ga('send', 'pageview');
    </script>
    
    
    <link href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic|Open+Sans|Roboto|Ubuntu" rel="stylesheet">

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raspberry Pi 3: Камера (#1) - первое включение, видео, фото, timelapse, отправка фото по e-mail - Codius.ru</title>
    <link href="/Content/fresco/fresco.css" rel="stylesheet"/>

    <script src="/Scripts/modernizr-2.8.3.js"></script>

    <script src="/Scripts/jquery-3.1.1.js"></script>

    <script src="/Scripts/lazyload/jquery.lazyload.min.js"></script>

    <link href="/Content/site.css" rel="stylesheet"/>
<link href="/Content/codius-logo-greyscale.css" rel="stylesheet"/>

    
    
    <script src="../../Scripts/manual/adaptiveblocks.js" type="text/javascript"></script>
    
    <script src='../../Scripts/manual/products.js' type='text/javascript'></script>
    <script src='../../Scripts/manual/article.js' type='text/javascript'></script>
    

    <link href="/Content/site_editproduct.css" rel="stylesheet">

    <script src="https://apis.google.com/js/platform.js"></script>
    <script src="/Scripts/jquery.color-2.1.2.min.js"></script>

    <script type='text/javascript' src='/Scripts/fresco/fresco_clear.js'></script>
    
    
    <script type="text/x-mathjax-config">
        //MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']], ignoreClass: "code"}});
        MathJax.Hub.Config({TeX: { equationNumbers: {autoNumber: "AMS"} } });

    </script>
    
    <script type="text/javascript" async
            src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>


    
    

    <script src="/Scripts/jquery-ui-1.12.1.min.js"></script>
    <script src="/Scripts/jquery.unobtrusive-ajax.min.js"></script>
    <link rel="stylesheet" href="../Content/Site_jqueryUI.css">
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

        <link rel="stylesheet" href="../Content/site_promo.css">
        <script src = "../../Scripts/js.cookie.js" ></script>



    </head>
    <body>


        <main>
            <header class="logocontainer">
                <div class="inner">
                    <a href="/"><div id="logo"></div></a>

                    <ul id="mainmenu">
    
    <li><a href="/products">Codius.Products v1.0 <sup class="smaller italic" style="color:red; text-decoration:none;">beta</sup></a></li>
    <li><a href="/donate">&#128176; Поддержать! <sup class="smaller italic" style="color:red; text-decoration:none;">new</sup></a></li>

    

    

</ul>



            </div>
    
    
    
        </header>
        <div id="content">
            










<br />
<br />




<div class="inner_art">
        <table id="paragraph00" border="0" cellpadding="0" cellspacing="0">
            <tr valign="top">
                <td style="width: 16%"></td>
                <td class="content" style="width: 68%">
                    <div id="divparagraph00">
                        <div style="position:relative; padding-left:45px;">
                            <div class="avatar-mini"></div>

        <span class="date">Обновлено 26 февраля 2018</span>



                            
                            <div class="author">Кравченко Виктор</div>

                        </div>

                        <h1 class="title">
                            Raspberry Pi 3: Камера<span class="sbrace"> </span><span class="hbrace">(</span>#1&#41; — первое включение, видео, фото, timelapse, отправка фото по e-mail
                            <a title="Постоянная ссылка" href="/articles/278"><img style="width:16px; height:16px;" src="/Content/icons/chain.ico" /></a>
                        </h1>
                        

                        


                        <div class="article-interests">
                        <a href="/interests/radioelectronics"><span class="item">Радиотехника и электроника</span></a>
                        <a href="/interests/digital"><span class="item">Цифровые устройства</span></a>
                        <a href="/interests/smarthouse"><span class="item">Умный дом</span></a>
                        <a href="/interests/raspberry"><span class="item">Raspberry</span></a>
                        </div>

                        <div class="article-tags">
                            <div class="tagicon"></div>
                        <span class="item">
                            <a href="/tags/camera">camera</a>, 
                        </span>
                        <span class="item">
                            <a href="/tags/%D1%83%D0%BC%D0%BD%D1%8B%D0%B9_%D0%B4%D0%BE%D0%BC">Умный дом</a>, 
                        </span>
                        <span class="item">
                            <a href="/tags/linux">Linux</a>, 
                        </span>
                        <span class="item">
                            <a href="/tags/%D0%BA%D0%B0%D0%BC%D0%B5%D1%80%D0%B0">камера</a>, 
                        </span>
                        <span class="item">
                            <a href="/tags/raspberry">Raspberry</a>, 
                        </span>
                        <span class="item">
                            <a href="/tags/model_b">Model B</a>, 
                        </span>
                        <span class="item">
                            <a href="/tags/pi_3">Pi 3</a>, 
                        </span>
                        <span class="item">
                            <a href="/tags/raspbian">Raspbian</a>, 
                        </span>
                        <span class="item">
                            <a href="/tags/raspberry_pi_3">Raspberry Pi 3</a>, 
                        </span>
                        <span class="item">
                            <a href="/tags/gpio">GPIO</a>, 
                        </span>
                        <span class="item">
                            <a href="/tags/timelapse">timelapse</a>
                        </span>
                        </div>



                        
                    </div>
                </td>
                <td style="width: 16%"></td>
            </tr>
        </table>
</div>



    <div style="margin-bottom:2.5em;"></div>



    <div class="inner_art inner-note"">
        <table class="note" id="paragraph01" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a01" href="/articles/278#a01">01</a>
    </td>
    <td class="leftpart">
        <span class="lang">На заметку:</span>
    </td>

                <td class="content">




                    <div id="divparagraph01"  >

                        <div class="parmainpart"  >

<b>У данной статьи есть видеоверсия!</b><br/><br/><iframe style="text-align:center;" height="315" src="//www.youtube.com/embed/VRnkIO4MbLo?rel=0" width="560" allowfullscreen frameborder="0">.</iframe><div class="videodescription" >Подписывайтесь на канал <div class="subscribebutton"><div class="g-ytsubscribe" data-channel="deftvk" data-layout="Default" data-count="Default"></div></div>, чтобы быть в курсе обновлений!</div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="custom">
        <table  id="paragraph02" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">


                <td >

        <div class="notvisible">
            <div class="pnum">
                <a name="a02" href="#02">02</a>
            </div>
        </div>



                    <div id="divparagraph02"  >

                        <div class="parmainpart"  >

<div style="margin-top:-1.5em; margin-bottom:-1em;"><div style="max-height: 500px;overflow:hidden;position: relative; height:500px;"><img style="width:100%; margin-top: -35%;top: 60%;position: absolute;left: 0;" id="1d235047-3e44-458e-b05a-817f00db69f1" class="nolazy fresco imgnodescr" data-fresco-group="article" alt src="/file/getfullimage/1d235047-3e44-458e-b05a-817f00db69f1" data-original="/file/getfullimage/1d235047-3e44-458e-b05a-817f00db69f1"/></div></div>


                        </div>
                    </div>

                </td>





            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph03" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a03" href="/articles/278#a03">03</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph03"  >

                        <div class="parmainpart"  >

    <p class="body sh">Введение</p>
            <p class="body">Существует всего 2&nbsp;вида камер, предлагаемых официальным сообществом Raspberry&nbsp;— обычная камера и камера ночного видения<span class="sbrace"> </span><span class="hbrace">(</span>инфракрасная камера для съемки в условиях слабого освещения&#41;:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph04" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a04" href="/articles/278#a04">04</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph04"  >

                        <div class="parmainpart"  >

<table style="margin-top:0;display:inline-block;" authorhas="false" excludefields="links,description" emptycolumn="false" class="products">


<tr style="visibility:hidden;">
    <td class="product" id="product319">
        <div class="buttons">
            <a href="/products/319"><img alt="Постоянная ссылка" title="Постоянная ссылка" src="/Content/icons/link.png" /></a>
            
        </div>

                <h4 id="product319" productid="319"><a href="/products/319">Камера для Raspberry Pi 3 (оригинал, 8 МП, 1080P/720P, v2.1)</a></h4><a name="p319"></a>
        
         <div style="text-align:center;">
                 <div class="thumb" style="position:relative;">
                     <img id="90f9ee85-2117-4728-a1ec-dcf661061794" class="lazy fresco" alt="Камера для Raspberry Pi 3 (оригинал, 8 МП, 1080P/720P, v2.1)" title="Камера для Raspberry Pi 3 (оригинал, 8 МП, 1080P/720P, v2.1)" data-fresco-caption="Камера для Raspberry Pi 3 (оригинал, 8 МП, 1080P/720P, v2.1)" style="display:inline-block;"
                          data-fresco-group="article" data-original="/file/getimage/90f9ee85-2117-4728-a1ec-dcf661061794" />
                     </div>
         </div>











    </td>

</tr>




<tr style="visibility:hidden;">
    <td class="product" id="product320">
        <div class="buttons">
            <a href="/products/320"><img alt="Постоянная ссылка" title="Постоянная ссылка" src="/Content/icons/link.png" /></a>
            
        </div>

                <h4 id="product320" productid="320"><a href="/products/320">Камера инфракрасная Pi NoIR для Raspberry Pi 3 (оригинал, 8 МП, 1080P/720P, v2.1)</a></h4><a name="p320"></a>
        
         <div style="text-align:center;">
                 <div class="thumb" style="position:relative;">
                     <img id="25e81f0c-873f-4927-ad95-21c149bd3d16" class="lazy fresco" alt="Камера инфракрасная Pi NoIR для Raspberry Pi 3 (оригинал, 8 МП, 1080P/720P, v2.1)" title="Камера инфракрасная Pi NoIR для Raspberry Pi 3 (оригинал, 8 МП, 1080P/720P, v2.1)" data-fresco-caption="Камера инфракрасная Pi NoIR для Raspberry Pi 3 (оригинал, 8 МП, 1080P/720P, v2.1)" style="display:inline-block;"
                          data-fresco-group="article" data-original="/file/getimage/25e81f0c-873f-4927-ad95-21c149bd3d16" />
                     </div>
         </div>











    </td>

</tr>

</table>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph05" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a05" href="/articles/278#a05">05</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph05"  >

                        <div class="parmainpart"  >

            <p class="body">Это второе поколение модулей с камерами для Raspberry Pi. От первого поколения они отличаются новой 8-мегапиксельной матрицей Sony IMX219&nbsp;с разрешением 3280×2464&nbsp;пикселей<span class="sbrace"> </span><span class="hbrace">(</span>подобные матрицы устанавливаются в некоторые мобильные телефоны&#41;, вместо 5-мегапиксельной OmniVision OV5647&nbsp;с разрешением 2592×1944&nbsp;пикселей. Замена матрицы не принесла увеличения производительности. Режимы записи видео остались прежними: <b>1080p30</b>, <b>720p60</b> и <b>640×480p60/90</b>. Тем не менее, был сделал серьезный скачок в качестве изображения.
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph06" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a06" href="/articles/278#a06">06</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph06"  >

                        <div class="parmainpart"  >

<img id="1c31c40a-02e6-4d8d-88c4-b84f5b74c443" class="lazy fresco imgnodescr" data-fresco-group="article" alt data-original="/file/getimage/1c31c40a-02e6-4d8d-88c4-b84f5b74c443"/>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph07" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a07" href="/articles/278#a07">07</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph07"  >

                        <div class="parmainpart"  >

            <p class="body">В данной статье будет использован китайский клон первой версии оригинальной камеры, так как он в 4&nbsp;раза дешевле оригинала:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="custom">
        <table  id="paragraph08" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">


                <td >

        <div class="notvisible">
            <div class="pnum">
                <a name="a08" href="#08">08</a>
            </div>
        </div>



                    <div id="divparagraph08"  >

                        <div class="parmainpart"  >

<div class="center" style="background-color: rgb(240, 244, 255);margin-top:-1em; padding-bottom:.8em;"><table minwidth="160" style="max-width:1600px; width:100%; background-color:white; font-size:85%;display:inline-block;" authorhas="false" excludefields="links,description" selectedid="318" exclude="323,319,320,326" emptycolumn="false" class="products">


<tr style="visibility:hidden;">
    <td class="product selected" id="product318">
        <div class="buttons">
            <a href="/products/318"><img alt="Постоянная ссылка" title="Постоянная ссылка" src="/Content/icons/link.png" /></a>
            
        </div>

                <h4 id="product318" productid="318"><a href="/products/318">Камера для Raspberry Pi 3 (клон, 5 МП, 1080P/720P, v1.3)</a></h4><a name="p318"></a>
        
         <div style="text-align:center;">
                 <div class="thumb" style="position:relative;">
                     <img id="8fa5b974-9099-47b8-8f5c-42b2ea2790fa" class="lazy fresco" alt="Камера для Raspberry Pi 3 (клон, 5 МП, 1080P/720P, v1.3)" title="Камера для Raspberry Pi 3 (клон, 5 МП, 1080P/720P, v1.3)" data-fresco-caption="Камера для Raspberry Pi 3 (клон, 5 МП, 1080P/720P, v1.3)" style="display:inline-block;"
                          data-fresco-group="article" data-original="/file/getimage/8fa5b974-9099-47b8-8f5c-42b2ea2790fa" />
                     </div>
         </div>











    </td>

</tr>




<tr style="visibility:hidden;">
    <td class="product" id="product321">
        <div class="buttons">
            <a href="/products/321"><img alt="Постоянная ссылка" title="Постоянная ссылка" src="/Content/icons/link.png" /></a>
            
        </div>

                <h4 id="product321" productid="321"><a href="/products/321">Камера инфракрасная для Raspberry Pi 3 (клон, 5 МП)</a></h4><a name="p321"></a>
        
         <div style="text-align:center;">
                 <div class="thumb" style="position:relative;">
                     <img id="20e5dfa4-74f5-4ec9-a1d5-63c5c12d716c" class="lazy fresco" alt="Камера инфракрасная для Raspberry Pi 3 (клон, 5 МП)" title="Камера инфракрасная для Raspberry Pi 3 (клон, 5 МП)" data-fresco-caption="Камера инфракрасная для Raspberry Pi 3 (клон, 5 МП)" style="display:inline-block;"
                          data-fresco-group="article" data-original="/file/getimage/20e5dfa4-74f5-4ec9-a1d5-63c5c12d716c" />
                     </div>
         </div>











    </td>

</tr>




<tr style="visibility:hidden;">
    <td class="product" id="product322">
        <div class="buttons">
            <a href="/products/322"><img alt="Постоянная ссылка" title="Постоянная ссылка" src="/Content/icons/link.png" /></a>
            
        </div>

                <h4 id="product322" productid="322"><a href="/products/322">Камера инфракрасная для Raspberry Pi 3 (клон, 5 МП) с ИК-подсветкой</a></h4><a name="p322"></a>
        
         <div style="text-align:center;">
                 <div class="thumb" style="position:relative;">
                     <img id="ccbbb2cf-796e-4a47-9ed6-cc8663f1e5fc" class="lazy fresco" alt="Камера инфракрасная для Raspberry Pi 3 (клон, 5 МП) с ИК-подсветкой" title="Камера инфракрасная для Raspberry Pi 3 (клон, 5 МП) с ИК-подсветкой" data-fresco-caption="Камера инфракрасная для Raspberry Pi 3 (клон, 5 МП) с ИК-подсветкой" style="display:inline-block;"
                          data-fresco-group="article" data-original="/file/getimage/ccbbb2cf-796e-4a47-9ed6-cc8663f1e5fc" />
                     </div>
         </div>











    </td>

</tr>




<tr style="visibility:hidden;">
    <td class="product" id="product325">
        <div class="buttons">
            <a href="/products/325"><img alt="Постоянная ссылка" title="Постоянная ссылка" src="/Content/icons/link.png" /></a>
            
        </div>

                <h4 id="product325" productid="325"><a href="/products/325">Камера инфракрасная широкоугольная "рыбий глаз" для Raspberry Pi 3 (клон, обзор 150°, 5 МП)</a></h4><a name="p325"></a>
        
         <div style="text-align:center;">
                 <div class="thumb" style="position:relative;">
                     <img id="fc4d394a-4f59-4de9-94c3-d69522956fdb" class="lazy fresco" alt="Камера инфракрасная широкоугольная &quot;рыбий глаз&quot; для Raspberry Pi 3 (клон, обзор 150&#176;, 5 МП)" title="Камера инфракрасная широкоугольная &quot;рыбий глаз&quot; для Raspberry Pi 3 (клон, обзор 150&#176;, 5 МП)" data-fresco-caption="Камера инфракрасная широкоугольная &quot;рыбий глаз&quot; для Raspberry Pi 3 (клон, обзор 150&#176;, 5 МП)" style="display:inline-block;"
                          data-fresco-group="article" data-original="/file/getimage/fc4d394a-4f59-4de9-94c3-d69522956fdb" />
                     </div>
         </div>











    </td>

</tr>




<tr style="visibility:hidden;">
    <td class="product" id="product324">
        <div class="buttons">
            <a href="/products/324"><img alt="Постоянная ссылка" title="Постоянная ссылка" src="/Content/icons/link.png" /></a>
            
        </div>

                <h4 id="product324" productid="324"><a href="/products/324">Камера широкоугольная "рыбий глаз" для Raspberry Pi 3 (клон, обзор 175/220°, 5 МП)</a></h4><a name="p324"></a>
        
         <div style="text-align:center;">
                 <div class="thumb" style="position:relative;">
                     <img id="f3e77a85-dd4f-49a3-9b9d-38c51d28d071" class="lazy fresco" alt="Камера широкоугольная &quot;рыбий глаз&quot; для Raspberry Pi 3 (клон, обзор 175/220&#176;, 5 МП)" title="Камера широкоугольная &quot;рыбий глаз&quot; для Raspberry Pi 3 (клон, обзор 175/220&#176;, 5 МП)" data-fresco-caption="Камера широкоугольная &quot;рыбий глаз&quot; для Raspberry Pi 3 (клон, обзор 175/220&#176;, 5 МП)" style="display:inline-block;"
                          data-fresco-group="article" data-original="/file/getimage/f3e77a85-dd4f-49a3-9b9d-38c51d28d071" />
                     </div>
         </div>











    </td>

</tr>




<tr style="visibility:hidden;">
    <td class="product" id="product457">
        <div class="buttons">
            <a href="/products/457"><img alt="Постоянная ссылка" title="Постоянная ссылка" src="/Content/icons/link.png" /></a>
            
        </div>

                <h4 id="product457" productid="457"><a href="/products/457">Шлейф FFC гибкий 15-пиновый 1 м (CSI)</a></h4><a name="p457"></a>
        
         <div style="text-align:center;">
                 <div class="thumb" style="position:relative;">
                     <img id="177c40be-a2d5-4a20-afe2-cb3ff9dcc196" class="lazy fresco" alt="Шлейф FFC гибкий 15-пиновый 1 м (CSI)" title="Шлейф FFC гибкий 15-пиновый 1 м (CSI)" data-fresco-caption="Шлейф FFC гибкий 15-пиновый 1 м (CSI)" style="display:inline-block;"
                          data-fresco-group="article" data-original="/file/getimage/177c40be-a2d5-4a20-afe2-cb3ff9dcc196" />
                     </div>
         </div>











    </td>

</tr>

</table></div>


                        </div>
                    </div>

                </td>





            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph09" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a09" href="/articles/278#a09">09</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph09"  >

                        <div class="parmainpart"  >

            <p class="body">Все описанное в данной статье также справедливо и для оригинальных камер.
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-note"">
        <table class="note" id="paragraph10" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a10" href="/articles/278#a10">10</a>
    </td>
    <td class="leftpart">
        <span class="lang">На заметку:</span>
    </td>

                <td class="content">




                    <div id="divparagraph10"  >

                        <div class="parmainpart"  >

Перед всеми манипуляциями, как обычно, необходимо обновить систему:<br/><div style="margin-top:1em;"><div class="code"><div class="linenumbers"><span class="linenum">1</span><br/>
<span class="linenum">2</span></div><div class="codecontainer">sudo apt-get update
sudo apt-get dist-upgrade</div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph11" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a11" href="/articles/278#a11">11</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph11"  >

                        <div class="parmainpart"  >

    <p class="body sh">Подключение и настройка</p>
            <p class="body">Камера общается с Малинкой по интерфейсу CSI, и подключается к специальному разъему на плате:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph12" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a12" href="/articles/278#a12">12</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph12"  >

                        <div class="parmainpart"  >

<img id="b398ede1-cf9e-4fba-a631-566965df2ac2" class="lazy fresco imgnodescr" data-fresco-group="article" alt data-original="/file/getimage/b398ede1-cf9e-4fba-a631-566965df2ac2"/>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-note"">
        <table class="note" id="paragraph13" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a13" href="/articles/278#a13">13</a>
    </td>
    <td class="leftpart">
        <span class="lang">На заметку:</span>
    </td>

                <td class="content">




                    <div id="divparagraph13"  >

                        <div class="parmainpart"  >

Интерфейс CSI, в отличие от USB-камер, позволяет не загружать процессор Малинки и использовать камеру максимально эффективно.


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-note"">
        <table class="note" id="paragraph14" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a14" href="/articles/278#a14">14</a>
    </td>
    <td class="leftpart">
        <span class="lang">На заметку:</span>
    </td>

                <td class="content">




                    <div id="divparagraph14"  >

                        <div class="parmainpart"  >

Камера потребляет ток 200-250мА&nbsp;— это необходимо учитывать, если используется слабый источник питания.


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph15" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a15" href="/articles/278#a15">15</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph15"  >

                        <div class="parmainpart"  >

            <p class="body">Подключив камеру к Малинке, в настройках Raspberry OS<span class="sbrace"> </span><span class="hbrace">(</span><span class="mono">Preferences → Raspberry Pi Configuration</span>&#41; необходимо включить возможность использования камеры&nbsp;— вкладка <span class="mono">Interfaces</span> пункт <span class="mono">Camera</span> кликнуть на <span class="mono">Enabled</span>.
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph16" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a16" href="/articles/278#a16">16</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph16"  >

                        <div class="parmainpart"  >

<img id="1485efe2-8c9d-4301-a03c-edbe741ceba1" class="lazy fresco imgnodescr" data-fresco-group="article" alt data-original="/file/getimage/1485efe2-8c9d-4301-a03c-edbe741ceba1"/>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                <div style="margin-top:2em;"/><br/>Для более удобной работы с камерой может пригодиться пластиковый кронштейн:<br/><table authorhas="false" excludefields="links,description" minwidth="160" emptycolumn="false" class="products" style="display:inline-block;">


<tr style="visibility:hidden;">
    <td class="product" id="product326">
        <div class="buttons">
            <a href="/products/326"><img alt="Постоянная ссылка" title="Постоянная ссылка" src="/Content/icons/link.png" /></a>
            
        </div>

                <h4 id="product326" productid="326"><a href="/products/326">Кронштейн монтажный пластиковый для модуля камеры Raspberry Pi 3</a></h4><a name="p326"></a>
        
         <div style="text-align:center;">
                 <div class="thumb" style="position:relative;">
                     <img id="e02e24ca-235c-4e27-9a85-e7e5ed21ce3f" class="lazy fresco" alt="Кронштейн монтажный пластиковый для модуля камеры Raspberry Pi 3" title="Кронштейн монтажный пластиковый для модуля камеры Raspberry Pi 3" data-fresco-caption="Кронштейн монтажный пластиковый для модуля камеры Raspberry Pi 3" style="display:inline-block;"
                          data-fresco-group="article" data-original="/file/getimage/e02e24ca-235c-4e27-9a85-e7e5ed21ce3f" />
                     </div>
         </div>











    </td>

</tr>

</table>
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph17" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a17" href="/articles/278#a17">17</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph17"  >

                        <div class="parmainpart"  >

<img id="91dc394b-ccd1-4bf6-bcc6-13ca215fc178" class="lazy fresco imgnodescr" data-fresco-group="article" alt data-original="/file/getimage/91dc394b-ccd1-4bf6-bcc6-13ca215fc178"/>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph18" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a18" href="/articles/278#a18">18</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph18"  >

                        <div class="parmainpart"  >

            <p class="body">После перезагрузки, камера готова к использованию.
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-note"">
        <table class="note" id="paragraph19" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a19" href="/articles/278#a19">19</a>
    </td>
    <td class="leftpart">
        <span class="lang">На заметку:</span>
    </td>

                <td class="content">




                    <div id="divparagraph19"  >

                        <div class="parmainpart"  >

В случае возникновения проблем с эксплуатацией камеры, в первую очередь, необходимо методом простой прозвонки, удостовериться в наличии контакта между Малинкой и камерой.<br/><br/><img id="a4bdc1cf-6351-4880-8943-b79123b24b86" class="lazy fresco imgnodescr" data-fresco-group="article" alt data-original="/file/getimage/a4bdc1cf-6351-4880-8943-b79123b24b86"/><br/><br/>Также нужно убедиться, что разъем, соединяющий камеру с платой, тоже надежно зафиксирован.


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph20" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a20" href="/articles/278#a20">20</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph20"  >

                        <div class="parmainpart"  >

    <p class="body sh">Базовый функционал</p>
            <p class="body">Для базовых манипуляций с камерой существует 3&nbsp;утилиты командной строки, которые предустановлены в системе: <ul style="margin:1em 0 -.5em 0;" class="list"><li><span class="mono">raspivid</span> — утилита для захвата видео,</li>
<li><span class="mono">raspistill</span> — утилита для захвата фотографий,</li>
<li><span class="mono">raspiyuv</span> — утилита, аналогичная <span class="mono">raspistill</span>, только вместо <span class="mono">jpg</span>-файлов, в результате генерирует <span class="mono">raw</span>-файлы<span class="sbrace"> </span><span class="hbrace">(</span>несжатые, необработанные&#41;.</li>
</ul>
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph21" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a21" href="/articles/278#a21">21</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph21"  >

                        <div class="parmainpart"  >

            <p class="body">Также эти утилиты позволяют осуществлять <b>Timelapse</b>-съемку&nbsp;— это такой вид съемки, при котором создается набор фотографий сделанных с заданным интервалом, который потом сшивается в одно видео, создавая эффект ускорения.
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph22" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a22" href="/articles/278#a22">22</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph22"  >

                        <div class="parmainpart"  >

            <p class="body">Все утилиты должны запускаться с параметрами.
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-note"">
        <table class="note" id="paragraph23" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a23" href="/articles/278#a23">23</a>
    </td>
    <td class="leftpart">
        <span class="lang">На заметку:</span>
    </td>

                <td class="content">




                    <div id="divparagraph23"  >

                        <div class="parmainpart"  >

Подробно о параметрах стандартных утилит по работе с камерой можно почитать на официальном ресурсе <a class="outersource" href="https://www.raspberrypi.org/documentation/raspbian/applications/camera.md">Raspberry Py Camera Module</a>. <br/><br/>Полный список параметров для каждой утилиты можно получить, если выполнить утилиту без параметров<br/><div style="margin-top:1em;"><div class="code"><div class="linenumbers"><span class="linenum">1</span></div><div class="codecontainer">raspistill</div></div></div><br/>либо выполнить утилиту с параметром <span class="mono">--help</span>:<br/><div style="margin-top:1em;"><div class="code"><div class="linenumbers"><span class="linenum">1</span></div><div class="codecontainer">raspistill --help</div></div></div><br/><img id="82b2d488-f1e0-4d4e-a9cf-6dc62d65f437" class="lazy fresco imgnodescr" data-fresco-group="article" alt data-original="/file/getimage/82b2d488-f1e0-4d4e-a9cf-6dc62d65f437"/>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph24" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a24" href="/articles/278#a24">24</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph24"  >

                        <div class="parmainpart"  >

            <p class="body">Ряд параметров является общим для всех этих утилит и разбит на 2&nbsp;группы: <ul style="margin:1em 0 -.5em 0;" class="list"><li>настройки окна просмотра, например: <ul style="margin:.5em 0 1em 0;" class="innerlist"><li><span class="mono">--preview</span>, <span class="mono">-p</span> — параметры окна просмотра <span class="mono">&lt;'x,y,w,h'&gt;</span></li><li><span class="mono">--opacity</span>, <span class="mono">-op</span> — установка прозрачности окна просмотра 0...255<span class="sbrace"> </span><span class="hbrace">(</span>0&nbsp;— абсолютно прозрачно, 255&nbsp;— непрозрачно&#41;</li></ul></li>
<li>настройки самой камеры, например: <ul style="margin:.5em 0 1em 0;" class="innerlist"><li><span class="mono">--contrast</span>, <span class="mono">-co</span> — контрастность<span class="sbrace"> </span><span class="hbrace">(</span>-100...100&#41;</li><li><span class="mono">--brightness</span>, <span class="mono">-br</span> — яркость<span class="sbrace"> </span><span class="hbrace">(</span>0...100&#41;</li><li><span class="mono">--exposure</span>, <span class="mono">-ex</span> — режим экспозиции</li><li><span class="mono">--annotate</span>, <span class="mono">-a</span> — добавление к изображению текстовых данных, например дата, время, настройки или произвольный текст</li></ul></li>
</ul>
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph25" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a25" href="/articles/278#a25">25</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph25"  >

                        <div class="parmainpart"  >

            <p class="body">Остальные параметры специфичны для каждой утилиты.
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-note"">
        <table class="note" id="paragraph26" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a26" href="/articles/278#a26">26</a>
    </td>
    <td class="leftpart">
        <span class="lang">На заметку:</span>
    </td>

                <td class="content">




                    <div id="divparagraph26"  >

                        <div class="parmainpart"  >

Необязательный параметр <span class="mono">-t</span> устанавливает время работы утилиты в миллисекундах. В случае работы утилиты <span class="mono">raspistill</span><span class="sbrace"> </span><span class="hbrace">(</span><span class="mono">raspiyuv</span>&#41;, фотография будет сделана по завершении этого времени. Для утилиты <span class="mono">raspivid</span> этот параметр задает длительность съемки видео.<br/><br/>Если параметр <span class="mono">-t</span> опущен, по умолчанию, используется время работы в 5&nbsp;секунд.


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-note"">
        <table class="note" id="paragraph27" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a27" href="/articles/278#a27">27</a>
    </td>
    <td class="leftpart">
        <span class="lang">На заметку:</span>
    </td>

                <td class="content">




                    <div id="divparagraph27"  >

                        <div class="parmainpart"  >

Если, горящий во время работы камеры, светодиод мешает<span class="sbrace"> </span><span class="hbrace">(</span>например, отражается в объектив во время ночной съемки через стекло&#41;, его можно отключить. Для этого в файл <span class="mono">config.txt</span>:<br/><div style="margin-top:1em;"><div class="code"><div class="linenumbers"><span class="linenum">1</span></div><div class="codecontainer">sudo nano /boot/config.txt</div></div></div><br/>Нужно добавить строку:<br/><div style="margin-top:1em;"><div class="code"><div class="linenumbers"><span class="linenum">1</span></div><div class="codecontainer">disable_camera_led=1</div></div></div><br/><img id="7e1c57d6-ab20-4bbe-91da-f60f95b7f99c" class="lazy fresco imgnodescr" data-fresco-group="article" alt data-original="/file/getimage/7e1c57d6-ab20-4bbe-91da-f60f95b7f99c"/><br/>После&nbsp;— сохранить файл <span class="mono">config.txt</span> и перезагрузить Малинку


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph28" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a28" href="/articles/278#a28">28</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph28"  >

                        <div class="parmainpart"  >

    <p class="body sh">Примеры использования стандартных утилит</p>
            <p class="body">Далее приведены примеры использования утилит:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph29" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a29" href="/articles/278#a29">29</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph29"  >

                        <div class="parmainpart"  >

<div><div class="code"><div class="linenumbers"><span class="linenum">1</span></div><div class="codecontainer">raspistill -t 2000 -o image.jpg -w 640 -h 480 -v</div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph30" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a30" href="/articles/278#a30">30</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph30"  >

                        <div class="parmainpart"  >

<div style="padding-left:2em; font-style:italic; margin:-.5em 0 .5em 0">Сделать фото с отсрочкой в 2&nbsp;секунды<span class="sbrace"> </span><span class="hbrace">(</span><span class="mono">-t 2000</span>&#41;, разрешением 640×480<span class="sbrace"> </span><span class="hbrace">(</span><span class="mono">-w 640 -h 480</span>&#41; с выводом информации во время работы утилиты<span class="sbrace"> </span><span class="hbrace">(</span><span class="mono">-v</span>&#41; и сохранить в файл <b>image.jpg</b><span class="sbrace"> </span><span class="hbrace">(</span><span class="mono">-o image.jpg</span>&#41;.</div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph31" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a31" href="/articles/278#a31">31</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph31"  >

                        <div class="parmainpart"  >

<div><div class="code"><div class="linenumbers"><span class="linenum">1</span></div><div class="codecontainer">raspivid -t 10000 -o video.h264</div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph32" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a32" href="/articles/278#a32">32</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph32"  >

                        <div class="parmainpart"  >

<div style="padding-left:2em; font-style:italic; margin:-.5em 0 .5em 0">Записать видео длиной 10&nbsp;секунд<span class="sbrace"> </span><span class="hbrace">(</span><span class="mono">-t 10000</span>&#41; и сохранить в файл <b>video.h264</b><span class="sbrace"> </span><span class="hbrace">(</span><span class="mono">-o video.h264</span>&#41;.</div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-note"">
        <table class="note" id="paragraph33" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a33" href="/articles/278#a33">33</a>
    </td>
    <td class="leftpart">
        <span class="lang">На заметку:</span>
    </td>

                <td class="content">




                    <div id="divparagraph33"  >

                        <div class="parmainpart"  >

Для отражения изображения по горизонтали/вертикали нужно использовать параметры <span class="mono">-hf</span> и <span class="mono">-vf</span>.


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph34" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a34" href="/articles/278#a34">34</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph34"  >

                        <div class="parmainpart"  >

            <p class="body">Для воспроизведения видео можно воспользоваться предустановленным плеером <b>OMXPlayer</b>. Если по каким-то причинам его нет, установить его можно командой:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph35" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a35" href="/articles/278#a35">35</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph35"  >

                        <div class="parmainpart"  >

<div><div class="code"><div class="linenumbers"><span class="linenum">1</span></div><div class="codecontainer">sudo apt-get install omxplayer</div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph36" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a36" href="/articles/278#a36">36</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph36"  >

                        <div class="parmainpart"  >

            <p class="body"><b>OMXPlayer</b> — плеер командной строки, без визуального интерфейса. Чтобы запустить ролик, нужно вызвать плеер с указанием, в качестве параметра, имени воспроизводимого файла:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph37" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a37" href="/articles/278#a37">37</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph37"  >

                        <div class="parmainpart"  >

<div><div class="code"><div class="linenumbers"><span class="linenum">1</span></div><div class="codecontainer">omxplayer video.h264</div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph38" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a38" href="/articles/278#a38">38</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph38"  >

                        <div class="parmainpart"  >

            <p class="body">Поскольку файлы с разрешением <span class="mono">.h264</span>, записанные утилитой <span class="mono">raspivid</span>, по сути являются сжатым видеопотоком без медиаконтейнера, то при попытке воспроизвести их, при помощи <b>OMXPlayer</b>, они будут воспроизводиться с увеличенной скоростью, вне зависимости от заданной при записи частоты кадров. Для того, чтобы сделать записанные файлы нормально воспроизводимыми, их нужно поместить в любой медиаконтейнер&nbsp;— <span class="mono">mkv</span>, <span class="mono">avi</span>, <span class="mono">mp4</span> и т.д. Делается это при помощи утилиты <span class="mono">avconv</span> — параметром <span class="mono">-r</span> задается частота кадров нового видео:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                <div style="padding-top:50px;">Более подробно речь об утилите <span class="mono">avconv</span> пойдет <a href="#a38">далее в статье</a>.</div>
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph39" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a39" href="/articles/278#a39">39</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph39"  >

                        <div class="parmainpart"  >

<div><div class="code"><div class="linenumbers"><span class="linenum">1</span></div><div class="codecontainer">avconv -i video.h264 -r 30 -vcodec copy video.mkv</div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-note"">
        <table class="note" id="paragraph40" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a40" href="/articles/278#a40">40</a>
    </td>
    <td class="leftpart">
        <span class="lang">На заметку:</span>
    </td>

                <td class="content">




                    <div id="divparagraph40"  >

                        <div class="parmainpart"  >

После того, как видео помещено в видеоконтейнер, воспроизвести его можно будет только при помощи <a id="243" class="codius" href="/articles/243">медиаплеера KODI</a><span class="sbrace"> </span><span class="hbrace">(</span>либо на любом настольном компьютере, в т.ч. и на Windows&#41;, так как он умеет использовать аппаратное декодирование видео. Ни OMXPlayer, ни VLCPlayer не смогут корректно воспроизвести полученный файл на Raspberry Pi 3.


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph41" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a41" href="/articles/278#a41">41</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph41"  >

                        <div class="parmainpart"  >

    <p class="body sh">Timelapse-видео</p>
            <p class="body">Процесс создания Timelapse-видео состоит из 2&nbsp;этапов. На первом этапе создается набор фотографий, сделанных с заданным интервалом при помощи утилиты <span class="mono">raspistill</span> с параметрами <span class="mono">-o</span>, <span class="mono">-t</span> и <span class="mono">-tl</span>:<ul style="margin:1em 0 -.5em 0;" class="list"><li><span class="mono">-o</span> — <b>имя файла</b>, должно содержать маску <span class="mono">%04d</span>, для того, чтобы утилита автоматически нумеровала файлы в соответствии с номером кадра. <b>04</b> в маске означает количество цифр в номере&nbsp;— 0000, 0001, 0002&nbsp;и т.д. Маска <span class="mono">%08d</span> подставит восьмизначный номер&nbsp;— 00000000, 00000001, 00000002, ... Например, <span class="mono">-o image%03d.jpg</span> будет генерировать имена файлов <span class="mono">image000.jpg</span>, <span class="mono">image001.jpg</span>, <span class="mono">image002.jpg</span> и т.д.</li>
<li><span class="mono">-t</span> — длительность работы камеры, в миллисекундах.</li>
<li><span class="mono">-tl</span> — интервал между кадрами, в миллисекундах. Если параметр <span class="mono">-tl</span> устанавливается равным нулю, то камера делает фото подряд с паузой примерно 30&nbsp;миллисекунд, это время необходимо для расчета экспозиции.</li>
</ul>
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph42" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a42" href="/articles/278#a42">42</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph42"  >

                        <div class="parmainpart"  >

            <p class="body">Пример:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph43" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a43" href="/articles/278#a43">43</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph43"  >

                        <div class="parmainpart"  >

<div><div class="code"><div class="linenumbers"><span class="linenum">1</span></div><div class="codecontainer">raspistill -o myphoto%04d.jpg -t 30000 -tl 2000</div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph44" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a44" href="/articles/278#a44">44</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph44"  >

                        <div class="parmainpart"  >

<div style="padding-left:2em; font-style:italic; margin:-.5em 0 .5em 0">Сделать серию фото в течение 30&nbsp;секунд<span class="sbrace"> </span><span class="hbrace">(</span><span class="mono">-t 30000</span>&#41;, с паузой между фотографиями в 2&nbsp;секунды<span class="sbrace"> </span><span class="hbrace">(</span><span class="mono">-tl 2000</span>&#41; и сохранить фотографии с именами <b>myphoto0000.jpg</b>, <b>myphoto0001.jpg</b>, <b>myphoto0002.jpg</b> и т.д. <span class="sbrace"> </span><span class="hbrace">(</span><span class="mono">-o myphoto%04d.jpg</span>&#41;.</div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-note"">
        <table class="note" id="paragraph45" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a45" href="/articles/278#a45">45</a>
    </td>
    <td class="leftpart">
        <span class="lang">На заметку:</span>
    </td>

                <td class="content">




                    <div id="divparagraph45"  >

                        <div class="parmainpart"  >

В случае появления сообщения о пропуске кадров <b>Skipping frame X to restart at frame Y</b>:<br/><img style="margin: .5em 0;" id="46e80c83-fd9f-4a8b-ba60-04ebcac63760" class="lazy fresco imgnodescr" data-fresco-group="article" alt data-original="/file/getimage/46e80c83-fd9f-4a8b-ba60-04ebcac63760"/><br/>Сообщение говорит о том, что камера не успевает сделать снимок и он будет пропущен, необходимо: <ul style="margin:1em 0 -.5em 0;" class="list"><li>увеличить паузу между кадрами<span class="sbrace"> </span><span class="hbrace">(</span>параметр <span class="mono">-tl</span>&#41;;</li>
<li>добавить в команду параметр <span class="mono">-md 1</span> — ручная установка режима съемки в 1<span class="sbrace"> </span><span class="hbrace">(</span>подробно о режимах <a class="outersource" href="https://www.raspberrypi.org/documentation/raspbian/applications/camera.md">здесь</a>&#41;;</li>
<li>добавить в команду параметр <span class="mono">-bm</span> — включение режима <b>burst capture mode</b><span class="sbrace"> </span><span class="hbrace">(</span>режим захвата пакетов&#41;.</li>
</ul>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph46" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a46" href="/articles/278#a46">46</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph46"  >

                        <div class="parmainpart"  >

            <p class="body">После этого все полученные снимки нужно собрать в одно видео при помощи утилиты <span class="mono">avconv</span>. 
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph47" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a47" href="/articles/278#a47">47</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph47"  >

                        <div class="parmainpart"  >

            <p class="body">Если утилита не установлена в системе, установить её можно командой:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph48" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a48" href="/articles/278#a48">48</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph48"  >

                        <div class="parmainpart"  >

<div><div class="code"><div class="linenumbers"><span class="linenum">1</span></div><div class="codecontainer">sudo apt-get install libav-tools</div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph49" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a49" href="/articles/278#a49">49</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph49"  >

                        <div class="parmainpart"  >

            <p class="body">Утилита <span class="mono">avconv</span> требовательна к нумерации файлов.
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph50" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a50" href="/articles/278#a50">50</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph50"  >

                        <div class="parmainpart"  >

            <p class="body">В случае, если необходимо собрать видео из файлов, нумерация которых начинается не с <span class="mono">0000</span>, необходимо привести имена файлов к виду, подходящему для обработки утилитой <span class="mono">avconv</span>
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph51" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a51" href="/articles/278#a51">51</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph51"  >

                        <div class="parmainpart"  >

            <p class="body">Для управления процессом сборки могут понадобиться некоторые параметры:<ul style="margin:1em 0 -.5em 0;" class="list"><li><span class="mono">-y</span> — наличие флага разрешает, не спрашивая, перезаписывать выходной файл.</li>
<li><span class="mono">-r <i>n</i></span> — в переменной <span class="mono"><i>n</i></span> указывается количество кадров в секунду выходного видео, например, <nobr><span class="mono">-r 10</span></nobr> — 10&nbsp;кадров в секунду.</li>
<li><span class="mono">-i <i>name</i></span> — шаблон имен файлов входной последовательности, например, <span class="mono">-i <i>myphoto%4d.jpg</i></span>, где фрагментом <span class="mono">%4d</span> задается формат нумерации<span class="sbrace"> </span><span class="hbrace">(</span>4&nbsp;цифры&#41;.</li>
<li><span class="mono">-vcodec</span> — задает кодек, при помощи которого нужно кодировать видео, например, для использования кодека <b>H.264</b>, нужно передать значение параметра <span class="mono">libx264</span>: <span class="mono">-vcodec <i>libx264</i></span><span class="sbrace"> </span><span class="hbrace">(</span>для получения списка доступных кодеков нужно утилите <span class="mono">avconv</span> передать параметр <span class="mono">-codecs</span>&#41;.</li>
<li><span class="mono">-q:v <i>n</i></span> — качество выходного видео, <span class="mono"><i>n</i></span> — значение из диапазона от 1<span class="sbrace"> </span><span class="hbrace">(</span>самое лучшее&#41; до 31<span class="sbrace"> </span><span class="hbrace">(</span>самое худшее&#41;.</li>
<li><span class="mono">-start_number <i>start</i></span> — если нумерация последовательности начинается не с <span class="mono">0</span>, то <span class="mono">start</span> принимает значение первого номера в последовательности, например, если последовательность содержит файлы с именами <span class="mono">image_0213.jpg</span>, <span class="mono">image_0214.jpg</span>, <span class="mono">image_0215.jpg</span> и т.д., то <span class="mono">start</span>=213: <span class="mono">-start_number 213</span></li>
</ul>
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                Подробно об утилите можно почитать на <a href="https://libav.org/avconv.html">официальной странице</a>.
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph52" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a52" href="/articles/278#a52">52</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph52"  >

                        <div class="parmainpart"  >

<div><div class="code"><div class="linenumbers"><span class="linenum">1</span></div><div class="codecontainer">avconv -start_number 213 -i image_%5d.jpg -r 30 -vcodec libx264 -q:v 3 output.mp4</div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-note"">
        <table class="note" id="paragraph53" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a53" href="/articles/278#a53">53</a>
    </td>
    <td class="leftpart">
        <span class="lang">На заметку:</span>
    </td>

                <td class="content">




                    <div id="divparagraph53"  >

                        <div class="parmainpart"  >

На самом деле возможности утилиты <span class="mono">avconv</span> намного шире. Например, с её помощью можно осуществлять видеозахват области со слежением за мышью с экрана вашей Малинки:<br/><div style="margin-top:1em; font-style:normal;"><div class="code"><div class="linenumbers"><span class="linenum">1</span></div><div class="codecontainer">avconv -f x11grab -follow_mouse centered -show_region 1 -r 25 -t 10 -s cif -i :0.0 video.mkv</div></div></div><br/>Ну а для полноценного захвата рабочего стола Малинка слабовата:<br/><div style="margin-top:1em; font-style:normal;"><div class="code"><div class="linenumbers"><span class="linenum">1</span></div><div class="codecontainer">avconv -f x11grab -r 25 -s 1920x1080 -t 10 -i :0.0 -vcodec libx264 video.mkv</div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph54" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a54" href="/articles/278#a54">54</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph54"  >

                        <div class="parmainpart"  >

    <p class="body sh">Использование камеры из Python&nbsp;— библиотека PiCamera</p>
            <p class="body">Помимо стандартных утилит, камеру можно использовать программными методами. Такой подход необходим, например, при построении систем безопасности, когда нужно активизировать запись, при наступлении какого-нибудь события или по расписанию.<div style="margin-top:1em; padding:.5em 1em .8em; font-size:1.1em; background-color:rgb(240,240,240);">Все скетчи на питоне, демонстрируемые далее, можно скачать как отдельно, по ссылке справа от каждого скетча, так и одним архивом&nbsp;— <a id="d9d36256-f472-4b7c-9e8d-52b997a4353d" filename="raspberry_camera_sketches.rar" class="file" imgid="d9d36256-f472-4b7c-9e8d-52b997a4353d" href="/file/download/d9d36256-f472-4b7c-9e8d-52b997a4353d">raspberry_camera_sketches.rar</a>&nbsp;<span class="filesize">(16,7 KB)</span>.</div>
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                Документация по работе с библиотекой PiCamera доступна в онлайн-режиме&nbsp;— <a href="https://picamera.readthedocs.io/en/release-1.13/">picamera.readthedocs.io</a>. Для доступа к документации в режиме оффлайн её можно установить командой:<br/><div style="margin-top:1em; font-style:normal;"><div class="code"><div class="linenumbers"><span class="linenum">1</span></div><div class="codecontainer">sudo apt-get install python-picamera-docs</div></div></div><br/><br/>Для оффлайн-установки библиотеки PiCamera доступен <a class="outersource" href="https://pypi.python.org/pypi/picamera/">репозиторий</a>.
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph55" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a55" href="/articles/278#a55">55</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph55"  >

                        <div class="parmainpart"  >

            <p class="body">Для работы с камерой в языке Python, понадобится библиотека <b>PiCamera</b>, которая предустановлена в системе. Если по какой-то причине её нет, то установить библиотеку можно командой:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph56" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a56" href="/articles/278#a56">56</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph56"  >

                        <div class="parmainpart"  >

<div><div class="code"><div class="linenumbers"><span class="linenum">1</span></div><div class="codecontainer">sudo apt-get install python3-picamera</div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-important"">
        <table class="important" id="paragraph57" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a57" href="/articles/278#a57">57</a>
    </td>
    <td class="leftpart">
        <span class="lang">Важно:</span>
    </td>

                <td class="content">




                    <div id="divparagraph57"  >

                        <div class="parmainpart"  >


Нельзя сохранять скетчи с именем <span class="mono">picamera.py</span> — это сделает невозможным использование библиотеки PiCamera в Python.



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph58" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a58" href="/articles/278#a58">58</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph58"  >

                        <div class="parmainpart"  >

            <p class="body">Когда библиотека установлена, в скетче её необходимо импортировать:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph59" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a59" href="/articles/278#a59">59</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph59"  >

                        <div class="parmainpart"  >

<div lang="py"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span></div><div class="codecontainer"><span class="keywords">import</span> picamera</div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph60" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a60" href="/articles/278#a60">60</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph60"  >

                        <div class="parmainpart"  >

            <p class="body">Также, для работы с временными паузами, нужно импортировать функцию <span class="mono">sleep()</span> из библиотеки <span class="mono">time</span>:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph61" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a61" href="/articles/278#a61">61</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph61"  >

                        <div class="parmainpart"  >

<div lang="py"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span></div><div class="codecontainer"><span class="keywords">from</span> time <span class="keywords">import</span> sleep</div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph62" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a62" href="/articles/278#a62">62</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph62"  >

                        <div class="parmainpart"  >

            <p class="body">Далее создается экземпляр класса <span class="mono">PiCamera</span>, с которым удобно работать:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph63" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a63" href="/articles/278#a63">63</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph63"  >

                        <div class="parmainpart"  >

<div lang="py"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span></div><div class="codecontainer">camera=picamera.PiCamera()</div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-note"">
        <table class="note" id="paragraph64" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a64" href="/articles/278#a64">64</a>
    </td>
    <td class="leftpart">
        <span class="lang">На заметку:</span>
    </td>

                <td class="content">




                    <div id="divparagraph64"  >

                        <div class="parmainpart"  >

Справку по объекту можно получить при помощи функции <span class="mono">help()</span>, выполнив последовательно в оболочке Shell команды:<br/><div lang="py" style="margin-top:1em; font-style:normal;"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span><br/>
<span class="linenum">2</span></div><div class="codecontainer">&gt;&gt;&gt; <span class="keywords">import</span> picamera
&gt;&gt;&gt; <span class="functions">help</span>(picamera)</div></div></div><br/>Либо вызвать функцию <span class="mono">print()</span> из кода программы:<br/><div lang="py" style="margin-top:1em; font-style:normal;"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span><br/>
<span class="linenum">2</span><br/>
<span class="linenum">3</span></div><div class="codecontainer"><span class="keywords">import</span> picamera
camera=picamera.PiCamera()
<span class="functions">print</span>(<span class="functions">help</span>(camera))</div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph65" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a65" href="/articles/278#a65">65</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph65"  >

                        <div class="parmainpart"  >

            <p class="body">Для корректного завершения работы с камерой и высвобождения занятых ресурсов, необходимо использовать метод <span class="mono">close()</span>. При вызове этого метода, будет также остановлена вся активность камеры&nbsp;— закрыто окно предпросмотра и завершена активная запись:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph66" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a66" href="/articles/278#a66">66</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph66"  >

                        <div class="parmainpart"  >

<div lang="py"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span></div><div class="codecontainer">camera.close()</div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph67" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a67" href="/articles/278#a67">67</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph67"  >

                        <div class="parmainpart"  >

            <p class="body">В соответствии с <a id="252#a58" class="codius" href="/articles/252#a58">условностями</a>, вызывать метод <span class="mono">close()</span> необходимо в разделе <span class="mono">finally</span> блока <span class="mono">try</span>:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph68" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a68" href="/articles/278#a68">68</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph68"  >

                        <div class="parmainpart"  >

<div lang="py" select="11"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span><br/>
<span class="linenum">2</span><br/>
<span class="linenum">3</span><br/>
<span class="linenum">4</span><br/>
<span class="linenum">5</span><br/>
<span class="linenum">6</span><br/>
<span class="linenum">7</span><br/>
<span class="linenum">8</span><br/>
<span class="linenum">9</span><br/>
<span class="linenum">10</span><br/>
<span class="linenum">11</span><br/>
<span class="linenum">12</span><br/>
<span class="linenum">13</span></div><div class="codecontainer"><span class="keywords">import</span> RPi.GPIO <span class="keywords">as</span> GPIO                 <span class="comments"># Импортируем библиотеку по работе с GPIO</span>
<span class="keywords">import</span> picamera                         <span class="comments"># Импортируем библиотеку PiCamera</span>
<span class="keywords">from</span>   time <span class="keywords">import</span> sleep
<span class="keywords">import</span> datetime <span class="keywords">as</span> dt

<span class="keywords">try</span>:
    camera = picamera.PiCamera()
    <span class="comments"># === Основной код ===</span>

<span class="keywords">finally</span>:
<div class="select">    camera.close()                      <span class="comments"># Корректно завершаем любую активность камеры</span></div>
    GPIO.cleanup()                      <span class="comments"># Возвращаем пины в исходное состояние</span>
    <span class="functions">print</span>(<span class="strings">"End of program"</span>)             <span class="comments"># Информируем о завершении работы программы</span></div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                <a id="8a4ace15-c825-43b9-8344-e917591e04da" filename="camera_001_template.py" class="file" imgid="8a4ace15-c825-43b9-8344-e917591e04da" href="/file/download/8a4ace15-c825-43b9-8344-e917591e04da">camera_001_ template.py</a>&nbsp;<span class="filesize">(698 Bytes)</span>
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph69" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a69" href="/articles/278#a69">69</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph69"  >

                        <div class="parmainpart"  >

            <p class="body">Для проверки работоспособности можно на 10&nbsp;секунд вызвать окно предпросмотра<span class="sbrace"> </span><span class="hbrace">(</span>preview window&#41;:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph70" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a70" href="/articles/278#a70">70</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph70"  >

                        <div class="parmainpart"  >

<div lang="py"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span><br/>
<span class="linenum">2</span><br/>
<span class="linenum">3</span><br/>
<span class="linenum">4</span><br/>
<span class="linenum">5</span><br/>
<span class="linenum">6</span><br/>
<span class="linenum">7</span></div><div class="codecontainer"><span class="keywords">import</span> picamera
<span class="keywords">from</span> time <span class="keywords">import</span> sleep
camera = picamera.PiCamera()

camera.start_preview()  <span class="comments"># Открываем окно предпросмотра</span>
sleep(10)               <span class="comments"># через 10 секунд</span>
camera.stop_preview()   <span class="comments"># Закрываем окно предпросмотра</span></div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                <a id="970346c1-15ed-4267-ab1b-e0d0e4e14379" filename="camera_002_preview.py" class="file" imgid="970346c1-15ed-4267-ab1b-e0d0e4e14379" href="/file/download/970346c1-15ed-4267-ab1b-e0d0e4e14379">camera_002_ preview.py</a>&nbsp;<span class="filesize">(924 Bytes)</span>
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph71" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a71" href="/articles/278#a71">71</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph71"  >

                        <div class="parmainpart"  >

            <p class="body">Для окна предпросмотра можно устанавливать прозрачность:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph72" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a72" href="/articles/278#a72">72</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph72"  >

                        <div class="parmainpart"  >

<div lang="py"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span><br/>
<span class="linenum">2</span><br/>
<span class="linenum">3</span></div><div class="codecontainer">camera.start_preview(alpha=190)  <span class="comments"># Открываем окно предпросмотра с прозрачностью 190 (255 - не прозрачно, 0 - прозрачно)</span>
<span class="comments"># или прозрачность можно изменить после открытия окна просмотра</span>
camera.preview.alpha = 100</div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph73" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a73" href="/articles/278#a73">73</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph73"  >

                        <div class="parmainpart"  >

            <p class="body">Теперь, можно, по аналогии с утилитами <span class="mono">raspistill</span> и <span class="mono">raspivid</span>, при помощи объекта <span class="mono">camera</span> сделать фото с камеры:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph74" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a74" href="/articles/278#a74">74</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph74"  >

                        <div class="parmainpart"  >

<div lang="py"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span><br/>
<span class="linenum">2</span><br/>
<span class="linenum">3</span><br/>
<span class="linenum">4</span><br/>
<span class="linenum">5</span></div><div class="codecontainer"><span class="comments"># Если не указывать абсолютный путь, файл будет создан в папке со скетчем</span>
camera.capture(<span class="strings">'image.jpg'</span>)
<span class="comments"># или</span>
<span class="comments"># можно указать абсолютный путь для сохранения</span>
camera.capture(<span class="strings">'/home/pi/image.jpg'</span>)</div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                <a id="e9ecff8b-5dc5-48c1-a062-b1a4bbef27f5" filename="camera_003_capture.py" class="file" imgid="e9ecff8b-5dc5-48c1-a062-b1a4bbef27f5" href="/file/download/e9ecff8b-5dc5-48c1-a062-b1a4bbef27f5">camera_003_ capture.py</a>&nbsp;<span class="filesize">(1,26 KB)</span>
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph75" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a75" href="/articles/278#a75">75</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph75"  >

                        <div class="parmainpart"  >

            <p class="body">Или записать видео:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph76" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a76" href="/articles/278#a76">76</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph76"  >

                        <div class="parmainpart"  >

<div lang="py"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span><br/>
<span class="linenum">2</span><br/>
<span class="linenum">3</span></div><div class="codecontainer">camera.start_recording(<span class="strings">'video.h264'</span>) <span class="comments"># Начинаем запись и сохраняем в файл video.h264</span>
camera.wait_recording(60)            <span class="comments"># Записываем 1 минуту, после чего</span>
camera.stop_recording()              <span class="comments"># Завершаем запись</span></div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                <a id="475a0bff-9c52-4b5c-b8b7-24c61f97f864" filename="camera_004_start_recording.py" class="file" imgid="475a0bff-9c52-4b5c-b8b7-24c61f97f864" href="/file/download/475a0bff-9c52-4b5c-b8b7-24c61f97f864">camera_004_ start_recording.py</a>&nbsp;<span class="filesize">(1,12 KB)</span>
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-note"">
        <table class="note" id="paragraph77" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a77" href="/articles/278#a77">77</a>
    </td>
    <td class="leftpart">
        <span class="lang">На заметку:</span>
    </td>

                <td class="content">




                    <div id="divparagraph77"  >

                        <div class="parmainpart"  >

Использование нативного метода <span class="mono">wait_recording()</span> для указания времени записи, предпочтительнее метода <span class="mono">sleep()</span> библиотеки <span class="mono">time</span>, потому что он отслеживает ошибки записи<span class="sbrace"> </span><span class="hbrace">(</span>например, ошибка нехватки места на диске&#41; в процессе работы. А при использовании метода <span class="mono">sleep()</span>, об ошибках станет известно только при остановке записи методом <span class="mono">stop_recording()</span>.


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph78" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a78" href="/articles/278#a78">78</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph78"  >

                        <div class="parmainpart"  >

            <p class="body">На фото/видео и окно предпросмотра можно накладывать текст и изменять его параметры&nbsp;— размер, цвет, цвет фона. В аннотациях, помимо цифр и знаков, допустимы только буквы латинского алфавита, при попытке отобразить кириллический символ будет выведена ошибка. В примере, в качестве текста используется актуальное время, которое обновляется каждые 200&nbsp;мс:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph79" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a79" href="/articles/278#a79">79</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph79"  >

                        <div class="parmainpart"  >

<div lang="py"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span><br/>
<span class="linenum">2</span><br/>
<span class="linenum">3</span><br/>
<span class="linenum">4</span><br/>
<span class="linenum">5</span><br/>
<span class="linenum">6</span><br/>
<span class="linenum">7</span><br/>
<span class="linenum">8</span><br/>
<span class="linenum">9</span><br/>
<span class="linenum">10</span><br/>
<span class="linenum">11</span><br/>
<span class="linenum">12</span><br/>
<span class="linenum">13</span><br/>
<span class="linenum">14</span><br/>
<span class="linenum">15</span><br/>
<span class="linenum">16</span><br/>
<span class="linenum">17</span><br/>
<span class="linenum">18</span><br/>
<span class="linenum">19</span><br/>
<span class="linenum">20</span></div><div class="codecontainer"><span class="keywords">import</span> picamera
<span class="keywords">import</span> datetime <span class="keywords">as</span> dt

camera = picamera.PiCamera()
camera.start_preview()                                                  <span class="comments"># Открыть окно предпросмотра</span>

camera.annotate_text = dt.datetime.now().strftime(<span class="strings">'%Y-%m-%d %H:%M:%S'</span>)  <span class="comments"># Выводим дату/время</span>
camera.annotate_text_size = 50                                          <span class="comments"># Размер текста из диапазона 6...160, по-умолчанию 32</span>
camera.annotate_foreground = picamera.Color(y=0.2, u=0, v=0)            <span class="comments"># Цвет текста - серый</span>
camera.annotate_background = picamera.Color(<span class="strings">'black'</span>)                    <span class="comments"># На черном фоне</span>

camera.start_recording(<span class="strings">'timestamped.h264'</span>)                              <span class="comments"># Начинаем запись</span>
start = dt.datetime.now()                                               <span class="comments"># Обнуляем счетчик</span>

<span class="keywords">while</span> (dt.datetime.now() - start).seconds &lt; 30:                         <span class="comments"># Пока не прошло 30 секунд</span>
    camera.annotate_text = dt.datetime.now().strftime(<span class="strings">'%Y-%m-%d %H:%M:%S'</span>)  <span class="comments"># Обновляем текст</span>
    camera.wait_recording(0.2)                                          <span class="comments"># Каждые 200 мс</span>
    
camera.stop_recording()                                                 <span class="comments"># Завершаем запись</span>
camera.stop_preview()                                                   <span class="comments"># Закрываем окно предпросмотра</span></div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                <a id="77b37e36-5911-4d04-900a-42f9bd9c2fdc" filename="camera_005_annotate.py" class="file" imgid="77b37e36-5911-4d04-900a-42f9bd9c2fdc" href="/file/download/77b37e36-5911-4d04-900a-42f9bd9c2fdc">camera_005_ annotate.py</a>&nbsp;<span class="filesize">(2,07 KB)</span>
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-note"">
        <table class="note" id="paragraph80" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a80" href="/articles/278#a80">80</a>
    </td>
    <td class="leftpart">
        <span class="lang">На заметку:</span>
    </td>

                <td class="content">




                    <div id="divparagraph80"  >

                        <div class="parmainpart"  >

Особенностью использования цветов отображения текста на изображении с камеры<span class="sbrace"> </span><span class="hbrace">(</span><b>annotate</b>&#41; является различие в задании цветов для фона<span class="sbrace"> </span><span class="hbrace">(</span><span class="mono">annotate_background</span>&#41; и самого текста<span class="sbrace"> </span><span class="hbrace">(</span><span class="mono">annotate_foreground</span>&#41;. Дело в том, что цвета для фона можно задавать удобными значениями <span class="mono">Color('yellow')</span>, <span class="mono">Color('blue')</span>, <span class="mono">Color('purple')</span> и т.д., в то время как цвет текста задается в формате <a class="outersource" href="https://ru.wikipedia.org/wiki/YUV">YUV</a> — <span class="mono">Color(y=0.2, u=0, v=0)</span>. Но не стоит пугаться сложности формул конвертации RGB в YUV&nbsp;— в свойстве <span class="mono">annotate_foreground</span> поддерживается только составляющая Y, которая по сути отвечает за яркость текста. На это указывает справка к классу <span class="mono">camera</span>:<br/><br/><img id="bf52868a-a465-47e9-bdcd-17ed1ec04a5c" class="lazy fresco imgnodescr" data-fresco-group="article" alt data-original="/file/getimage/bf52868a-a465-47e9-bdcd-17ed1ec04a5c"/>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph81" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a81" href="/articles/278#a81">81</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph81"  >

                        <div class="parmainpart"  >

            <p class="body">Объект <span class="mono">camera</span> позволяет задавать настройки для камеры:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph82" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a82" href="/articles/278#a82">82</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph82"  >

                        <div class="parmainpart"  >

<div lang="py"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span><br/>
<span class="linenum">2</span><br/>
<span class="linenum">3</span><br/>
<span class="linenum">4</span><br/>
<span class="linenum">5</span><br/>
<span class="linenum">6</span><br/>
<span class="linenum">7</span><br/>
<span class="linenum">8</span><br/>
<span class="linenum">9</span><br/>
<span class="linenum">10</span></div><div class="codecontainer">camera.sharpness = 0                <span class="comments"># Резкость     </span>
camera.contrast = 0                 <span class="comments"># Контрастность</span>
camera.brightness = 50              <span class="comments"># Яркость</span>
camera.saturation = 0               <span class="comments"># Насыщенность  </span>
camera.ISO = 0                      <span class="comments"># Чувствительность</span>
camera.rotation = 0                 <span class="comments"># Поворот</span>
camera.hflip = <span class="keywords">False</span>                <span class="comments"># Отражение по горизонтали</span>
camera.vflip = <span class="keywords">False</span>                <span class="comments"># Отражение по вертикали</span>
camera.crop = (0.0, 0.0, 1.0, 1.0)  <span class="comments"># Обрезка</span>
camera.awb_mode = <span class="strings">"sunlight"</span>        <span class="comments"># Баланс белого</span></div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph83" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a83" href="/articles/278#a83">83</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph83"  >

                        <div class="parmainpart"  >

            <p class="body">И изменять их во времени:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph84" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a84" href="/articles/278#a84">84</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph84"  >

                        <div class="parmainpart"  >

<div lang="py"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span><br/>
<span class="linenum">2</span><br/>
<span class="linenum">3</span><br/>
<span class="linenum">4</span><br/>
<span class="linenum">5</span></div><div class="codecontainer">camera.start_preview()
<span class="keywords">for</span> i <span class="keywords">in</span> <span class="functions">range</span>(100):
    camera.brightness = i           <span class="comments"># Каждые 100 миллисекунд меняем яркость от 0 до 100</span>
    sleep(0.1)
camera.stop_preview()</div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                <a id="87395e70-fbf2-4cf7-87c5-e80f4360c8ee" filename="camera_006_params_change_brightness.py" class="file" imgid="87395e70-fbf2-4cf7-87c5-e80f4360c8ee" href="/file/download/87395e70-fbf2-4cf7-87c5-e80f4360c8ee">camera_006_ params_change_ brightness.py</a>&nbsp;<span class="filesize">(1,83 KB)</span>
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph85" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a85" href="/articles/278#a85">85</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph85"  >

                        <div class="parmainpart"  >

            <p class="body">Конструктор класса <b>PiCamera</b> <a class="outersource" href="https://picamera.readthedocs.io/en/release-1.13/api_camera.html#picamera">позволяет задавать некоторые настройки</a> при создании экземпляра класса <span class="mono">PiCamera</span>:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph86" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a86" href="/articles/278#a86">86</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph86"  >

                        <div class="parmainpart"  >

<div lang="py"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span><br/>
<span class="linenum">2</span></div><div class="codecontainer"><span class="keywords">import</span> picamera
camera = picamera.PiCamera(sensor_mode=6, framerate=24)</div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-note"">
        <table class="note" id="paragraph87" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a87" href="/articles/278#a87">87</a>
    </td>
    <td class="leftpart">
        <span class="lang">На заметку:</span>
    </td>

                <td class="content">




                    <div id="divparagraph87"  >

                        <div class="parmainpart"  >

Параметр <span class="mono">sensor_mode</span> задает одну из базовых настроек, поддерживаемых камерой на аппаратном уровне. Варианты значений и диапазоны допустимых частот кадров <a href="https://picamera.readthedocs.io/en/release-1.13/fov.html#sensor-modes">описаны в документации</a>.


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph88" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a88" href="/articles/278#a88">88</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph88"  >

                        <div class="parmainpart"  >

            <p class="body">Перед тем, как сделать фото или записать видео, можно настроить разрешение и частоту кадров:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph89" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a89" href="/articles/278#a89">89</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph89"  >

                        <div class="parmainpart"  >

<div lang="py"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span><br/>
<span class="linenum">2</span></div><div class="codecontainer">camera.resolution = (1280, 720)     <span class="comments"># Разрешение</span>
camera.framerate = 24               <span class="comments"># Частота кадров</span></div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph90" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a90" href="/articles/278#a90">90</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph90"  >

                        <div class="parmainpart"  >

            <p class="body">Причем, отдельно задать размер фото/видео можно при вызове методов <span class="mono">capture()</span> и <span class="mono">start_recording()</span>, передав нужное значение параметра <span class="mono">resize</span>:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph91" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a91" href="/articles/278#a91">91</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph91"  >

                        <div class="parmainpart"  >

<div lang="py"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span><br/>
<span class="linenum">2</span><br/>
<span class="linenum">3</span></div><div class="codecontainer">camera.resolution = (1280, 720)                            <span class="comments"># Разрешение по-умолчанию</span>
camera.capture(<span class="strings">'image.jpg'</span>, resize=(320, 240))             <span class="comments"># Изменить разрешение фото</span>
camera.start_recording(<span class="strings">'video.h264'</span>, resize=(640, 480))    <span class="comments"># Изменить разрешение видео</span></div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph92" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a92" href="/articles/278#a92">92</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph92"  >

                        <div class="parmainpart"  >

            <p class="body">К изображению камеры можно применять различные эффекты:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph93" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a93" href="/articles/278#a93">93</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph93"  >

                        <div class="parmainpart"  >

<div lang="py"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span><br/>
<span class="linenum">2</span><br/>
<span class="linenum">3</span><br/>
<span class="linenum">4</span><br/>
<span class="linenum">5</span><br/>
<span class="linenum">6</span></div><div class="codecontainer">camera.start_preview()
<span class="keywords">for</span> effect <span class="keywords">in</span> camera.IMAGE_EFFECTS:                <span class="comments"># Поочередно получаем все доступные эффекты</span>
    camera.image_effect = effect		   <span class="comments"># И применяем их к изображению</span>
    camera.annotate_text = <span class="strings">"Effect: %s"</span> % effect   <span class="comments"># Накладываем на изображение название примененного эффекта</span>
    sleep(5)                                       <span class="comments"># Можно смело использовать sleep() так как запись не ведется</span>
camera.stop_preview()</div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                <a id="5bc46521-a11a-489c-a62a-890daaa6d63d" filename="camera_007_effects.py" class="file" imgid="5bc46521-a11a-489c-a62a-890daaa6d63d" href="/file/download/5bc46521-a11a-489c-a62a-890daaa6d63d">camera_007_ effects.py</a>&nbsp;<span class="filesize">(1,72 KB)</span>
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph94" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a94" href="/articles/278#a94">94</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph94"  >

                        <div class="parmainpart"  >

            <p class="body">Аналогичным образом можно перебрать варианты настройки баланса белого <span class="mono">awb_mode</span> и варианты режимов экспозиции <span class="mono">exposure_mode</span>:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph95" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a95" href="/articles/278#a95">95</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph95"  >

                        <div class="parmainpart"  >

<div lang="py"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span><br/>
<span class="linenum">2</span><br/>
<span class="linenum">3</span><br/>
<span class="linenum">4</span><br/>
<span class="linenum">5</span><br/>
<span class="linenum">6</span><br/>
<span class="linenum">7</span><br/>
<span class="linenum">8</span><br/>
<span class="linenum">9</span><br/>
<span class="linenum">10</span><br/>
<span class="linenum">11</span><br/>
<span class="linenum">12</span><br/>
<span class="linenum">13</span></div><div class="codecontainer">camera.start_preview()

<span class="keywords">for</span> mode <span class="keywords">in</span> camera.AWB_MODES:                	   <span class="comments"># Поочередно получаем все доступные режимы баланса белого</span>
    camera.awb_mode = mode			   <span class="comments"># И задаем режим работы камеры</span>
    camera.annotate_text = <span class="strings">"AWB mode: %s"</span> % mode   <span class="comments"># Накладываем на изображение название режима баланса белого</span>
    sleep(5)                                       <span class="comments"># Можно смело использовать sleep() так как запись не ведется</span>
<span class="comments"># или</span>
<span class="keywords">for</span> mode <span class="keywords">in</span> camera.EXPOSURE_MODES:                 <span class="comments"># Выводим поочередно все доступные режимы экспозиции</span>
    camera.exposure_mode = mode			   <span class="comments"># И задаем режим работы камеры</span>
    camera.annotate_text = <span class="strings">"Exposure: %s"</span> % mode   <span class="comments"># Накладываем на изображение название режима экспозиции</span>
    sleep(5)                                       <span class="comments"># Можно смело использовать sleep() так как запись не ведется</span>

camera.stop_preview()</div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                <a id="9662779d-49bc-4dd2-8249-4d609ccf202c" filename="camera_008_modes_awb.py" class="file" imgid="9662779d-49bc-4dd2-8249-4d609ccf202c" href="/file/download/9662779d-49bc-4dd2-8249-4d609ccf202c">camera_008_ modes_awb.py</a>&nbsp;<span class="filesize">(2,26 KB)</span>
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph96" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a96" href="/articles/278#a96">96</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph96"  >

                        <div class="parmainpart"  >

            <p class="body">При помощи метода <span class="mono">capture_continuous()</span>, не составит труда сгенерировать набор фотографий для <b>Timelapse</b>. В примере фото делается в начале каждого часа:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph97" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a97" href="/articles/278#a97">97</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph97"  >

                        <div class="parmainpart"  >

<div lang="py"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span><br/>
<span class="linenum">2</span><br/>
<span class="linenum">3</span><br/>
<span class="linenum">4</span><br/>
<span class="linenum">5</span><br/>
<span class="linenum">6</span><br/>
<span class="linenum">7</span><br/>
<span class="linenum">8</span><br/>
<span class="linenum">9</span><br/>
<span class="linenum">10</span><br/>
<span class="linenum">11</span><br/>
<span class="linenum">12</span><br/>
<span class="linenum">13</span><br/>
<span class="linenum">14</span><br/>
<span class="linenum">15</span><br/>
<span class="linenum">16</span><br/>
<span class="linenum">17</span><br/>
<span class="linenum">18</span><br/>
<span class="linenum">19</span><br/>
<span class="linenum">20</span><br/>
<span class="linenum">21</span><br/>
<span class="linenum">22</span><br/>
<span class="linenum">23</span><br/>
<span class="linenum">24</span><br/>
<span class="linenum">25</span><br/>
<span class="linenum">26</span><br/>
<span class="linenum">27</span><br/>
<span class="linenum">28</span></div><div class="codecontainer"><span class="keywords">import</span> RPi.GPIO <span class="keywords">as</span> GPIO                 <span class="comments"># Импортируем библиотеку по работе с GPIO</span>
<span class="keywords">import</span> picamera                         <span class="comments"># Импортируем библиотеку PiCamera</span>
<span class="keywords">from</span>   time <span class="keywords">import</span> sleep
<span class="keywords">from</span>   datetime <span class="keywords">import</span> datetime, timedelta

<span class="keywords">def</span> <span class="userfunctions">wait</span>():                             <span class="comments"># Функция расчета точной паузы между снимками</span>
    next_minute = (datetime.now() + timedelta(seconds=60))      <span class="comments"># Добавляем минуту к текущему времени</span>
    next_minute = next_minute.replace(second=0, microsecond=0)  <span class="comments"># Обнуляем секунды/миллисекунды</span>
    now         = datetime.now()
    delay       = ((next_minute - now).seconds +             
                  (next_minute - now).microseconds/1000000) <span class="comments"># Получаем разницу в секундах c точностью до микросекунд</span>
    sleep(delay)                                            <span class="comments"># Ждем</span>
    
<span class="keywords">try</span>:
    camera = picamera.PiCamera()

    camera.start_preview()
    wait()                              <span class="comments"># Ждем наступления новой минуты</span>
    <span class="keywords">for</span> filename <span class="keywords">in</span> camera.capture_continuous(<span class="strings">'img_{timestamp:%Y-%m-%d-%H-%M}.jpg'</span>):
        <span class="functions">print</span>(<span class="strings">'Captured %s'</span> % filename)
        wait()                          <span class="comments"># Функция для точного расчета паузы между снимками, для упрощения можно заменить на sleep()</span>

    camera.stop_preview()               <span class="comments"># Закрываем окно предпросмотра</span>

<span class="keywords">finally</span>:
    camera.close()                      <span class="comments"># Корректно завершаем любую активность камеры</span>
    GPIO.cleanup()                      <span class="comments"># Возвращаем пины в исходное состояние</span>
    <span class="functions">print</span>(<span class="strings">"End of program"</span>)             <span class="comments"># Информируем о завершении работы программы</span></div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                <a id="caf395b2-c3e2-4262-9149-9d5a8bbc5da4" filename="camera_009_timelapse.py" class="file" imgid="caf395b2-c3e2-4262-9149-9d5a8bbc5da4" href="/file/download/caf395b2-c3e2-4262-9149-9d5a8bbc5da4">camera_009_ timelapse.py</a>&nbsp;<span class="filesize">(2,00 KB)</span>
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph98" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a98" href="/articles/278#a98">98</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph98"  >

                        <div class="parmainpart"  >

            <p class="body">Отключить мешающий светодиод можно свойством <span class="mono">led</span>:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-note"">
        <table class="note" id="paragraph99" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a99" href="/articles/278#a99">99</a>
    </td>
    <td class="leftpart">
        <span class="lang">На заметку:</span>
    </td>

                <td class="content">




                    <div id="divparagraph99"  >

                        <div class="parmainpart"  >

Поскольку при подключении камеры, пин управления светодиодом камеры перемещается в GPIO Малинки и становится недоступным напрямую для процессора ARM, этот метод работает только при установленной библиотеке <a id="254" class="codius" href="/articles/254">RPi.GPIO</a> и при установленном режиме пинов <span class="mono">BCM</span> — <span class="mono">GPIO.setmode(GPIO.BCM)</span>.


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph100" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a100" href="/articles/278#a100">100</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph100"  >

                        <div class="parmainpart"  >

<div lang="py"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span><br/>
<span class="linenum">2</span><br/>
<span class="linenum">3</span><br/>
<span class="linenum">4</span><br/>
<span class="linenum">5</span><br/>
<span class="linenum">6</span></div><div class="codecontainer"><span class="keywords">import</span> RPi.GPIO <span class="keywords">as</span> GPIO
<span class="keywords">import</span> picamera 

GPIO.setmode(GPIO.BCM)
camera = picamera.PiCamera()
camera.led = <span class="keywords">False</span></div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph101" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a101" href="/articles/278#a101">101</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph101"  >

                        <div class="parmainpart"  >

    <p class="body sh">Использование камеры из Python&nbsp;— библиотека PiCamera<span class="sbrace"> </span><span class="hbrace">(</span>продвинутый уровень&#41;</p>
            <p class="body">Библиотека <b>PiCamera</b> предоставляет очень широкие возможности по взаимодействию с камерой. Ниже представлены примеры решения некоторых неочевидных задач.
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph102" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a102" href="/articles/278#a102">102</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph102"  >

                        <div class="parmainpart"  >

            <p class="body"><b>Захват видео в несколько потоков</b><span class="sbrace"> </span><span class="hbrace">(</span>максимум 4&#41;. Для каждого из них, при помощи параметра <span class="mono">resize</span> можно устанавливать индивидуальное разрешение. Каждый поток идентифицируется параметром <span class="mono">splitter_port</span><span class="sbrace"> </span><span class="hbrace">(</span>0, 1, 2, 3&#41;:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph103" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a103" href="/articles/278#a103">103</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph103"  >

                        <div class="parmainpart"  >

<div lang="py"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span><br/>
<span class="linenum">2</span><br/>
<span class="linenum">3</span><br/>
<span class="linenum">4</span><br/>
<span class="linenum">5</span><br/>
<span class="linenum">6</span><br/>
<span class="linenum">7</span><br/>
<span class="linenum">8</span><br/>
<span class="linenum">9</span><br/>
<span class="linenum">10</span></div><div class="codecontainer"><span class="comments"># Команда без параметра splitter_port по умолчанию занимает порт 1</span>
camera.start_recording(<span class="strings">'sp_highres.h264'</span>)                                      <span class="comments"># Запускаем запись видео с параметрами по умолчанию</span>
camera.start_recording(<span class="strings">'sp_lowres.h264'</span>, splitter_port=0, resize=(640, 480))   <span class="comments"># Параллельно запускаем другой поток с уменьшенным разрешением</span>
camera.start_recording(<span class="strings">'sp_lowres.h264'</span>, splitter_port=2, resize=(320, 240))   <span class="comments"># Параллельно запускаем другой поток с ещё более уменьшенным разрешением</span>
 
camera.wait_recording(60)                                                   <span class="comments"># Записываем 1 минуту видео</span>
 
camera.stop_recording()                                                     <span class="comments"># Останавливаем запись всех потоков по очереди</span>
camera.stop_recording(splitter_port=0) 
camera.stop_recording(splitter_port=2) </div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                <a id="a0e64960-aa67-4a5e-ae70-f4606fc46347" filename="camera_010_splitter_port.py" class="file" imgid="a0e64960-aa67-4a5e-ae70-f4606fc46347" href="/file/download/a0e64960-aa67-4a5e-ae70-f4606fc46347">camera_010_ splitter_port.py</a>&nbsp;<span class="filesize">(1,96 KB)</span>
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph104" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a104" href="/articles/278#a104">104</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph104"  >

                        <div class="parmainpart"  >

            <p class="body"><b>Разделение видеопотока и сохранение его в разные файлы.</b> Функция бывает полезна, например, для циклической записи видеоданных равной продолжительности в определенное количество файлов, таким образом, что, после того, как будет записан последний файл, данные начнут записываться заново в первый файл<span class="sbrace"> </span><span class="hbrace">(</span>принцип работы видеорегистратора&#41;. 
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-note"">
        <table class="note" id="paragraph105" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a105" href="/articles/278#a105">105</a>
    </td>
    <td class="leftpart">
        <span class="lang">На заметку:</span>
    </td>

                <td class="content">




                    <div id="divparagraph105"  >

                        <div class="parmainpart"  >

Нельзя использовать данный метод для построения систем безопасности с круглосуточной записью видео&nbsp;— это выведет из строя накопитель, который не предназначен для таких режимов работы.


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph106" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a106" href="/articles/278#a106">106</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph106"  >

                        <div class="parmainpart"  >

            <p class="body">При чем возможна реализация двумя способами. При помощи <span class="mono">split_recording()</span>:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph107" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a107" href="/articles/278#a107">107</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph107"  >

                        <div class="parmainpart"  >

<div lang="py"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span><br/>
<span class="linenum">2</span><br/>
<span class="linenum">3</span><br/>
<span class="linenum">4</span><br/>
<span class="linenum">5</span><br/>
<span class="linenum">6</span><br/>
<span class="linenum">7</span><br/>
<span class="linenum">8</span><br/>
<span class="linenum">9</span><br/>
<span class="linenum">10</span><br/>
<span class="linenum">11</span><br/>
<span class="linenum">12</span><br/>
<span class="linenum">13</span><br/>
<span class="linenum">14</span><br/>
<span class="linenum">15</span></div><div class="codecontainer"><span class="keywords">import</span> picamera                                     <span class="comments"># Импортируем библиотеку PiCamera</span>
camera = picamera.PiCamera(resolution=(640, 480))   <span class="comments"># Задаем разрешение при инициализации</span>
camera.start_preview()                              <span class="comments"># Открываем окно предпросмотра</span>

camera.start_recording(<span class="strings">'/home/pi/1.h264'</span>)           <span class="comments"># Начинаем записывать в файл #1</span>
camera.wait_recording(5)                            <span class="comments"># Записываем 5 секунд</span>
startindex = 2                                      <span class="comments"># Задаем начальный индекс</span>
<span class="keywords">while</span>(1):                                           <span class="comments"># Бесконечный цикл</span>
    <span class="keywords">for</span> i <span class="keywords">in</span> <span class="functions">range</span>(startindex, 11):                 <span class="comments"># Будем разделять в файлы с именами от 1.h264 до 10.h264</span>
        camera.split_recording(<span class="strings">'/home/pi/%d.h264'</span> % i) <span class="comments"># Разделяем видеопоток</span>
        camera.wait_recording(5)                    <span class="comments"># Записываем 5 секунд</span>
    startindex = 1                                  <span class="comments"># После записи 10 файла возвращем индекс к началу</span>
camera.stop_recording()                             <span class="comments"># Останавливаем запись</span>

camera.stop_preview()                               <span class="comments"># Закрываем окно предпросмотра</span></div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                <a id="438df361-f65b-4523-926d-2f8ae3e364b1" filename="camera_011_01_split_recording.py" class="file" imgid="438df361-f65b-4523-926d-2f8ae3e364b1" href="/file/download/438df361-f65b-4523-926d-2f8ae3e364b1">camera_011_01_ split_recording.py</a>&nbsp;<span class="filesize">(1,96 KB)</span>
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph108" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a108" href="/articles/278#a108">108</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph108"  >

                        <div class="parmainpart"  >

            <p class="body">И при помощи <span class="mono">record_sequence()</span>:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph109" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a109" href="/articles/278#a109">109</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph109"  >

                        <div class="parmainpart"  >

<div lang="py"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span><br/>
<span class="linenum">2</span><br/>
<span class="linenum">3</span><br/>
<span class="linenum">4</span><br/>
<span class="linenum">5</span><br/>
<span class="linenum">6</span><br/>
<span class="linenum">7</span><br/>
<span class="linenum">8</span><br/>
<span class="linenum">9</span><br/>
<span class="linenum">10</span><br/>
<span class="linenum">11</span></div><div class="codecontainer"><span class="keywords">import</span> picamera                         <span class="comments"># Импортируем библиотеку PiCamera</span>

camera = picamera.PiCamera(resolution=(640, 480))   <span class="comments"># Задаем разрешение при инициализации</span>
camera.start_preview()                              <span class="comments"># Открываем окно предпросмотра</span>
<span class="keywords">while</span>(1):                                           <span class="comments"># Бесконечный цикл</span>
    <span class="keywords">for</span> filename <span class="keywords">in</span> camera.record_sequence(
            <span class="strings">'/home/pi/%d.h264'</span> % i <span class="keywords">for</span> i <span class="keywords">in</span> <span class="functions">range</span>(1, 11)):  <span class="comments"># Будем разделять в файлы с именами от 1.h264 до 10.h264</span>
        camera.wait_recording(5)                    <span class="comments"># Записываем 5 секунд</span>

camera.stop_recording()                             <span class="comments"># Останавливаем запись</span>
camera.stop_preview()                               <span class="comments"># Закрываем окно предпросмотра</span></div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                <a id="4604a311-8ffc-4b62-b814-76a05551096e" filename="camera_011_02_record_sequence.py" class="file" imgid="4604a311-8ffc-4b62-b814-76a05551096e" href="/file/download/4604a311-8ffc-4b62-b814-76a05551096e">camera_011_02_ record_sequence.py</a>&nbsp;<span class="filesize">(1,45 KB)</span>
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph110" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a110" href="/articles/278#a110">110</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph110"  >

                        <div class="parmainpart"  >

            <p class="body"><b>Постоянная циклическая запись видеопотока в буфер с последующим сохранением его в файл по заданному сигналу.</b> При использовании этого способа можно строить системы безопасности, в которых запись потока в файл будет производиться по заданному событию. Преимуществом данного способа является сохранение видео, которое также, при необходимости, будет содержать данные, предшествующие наступлению события.
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph111" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a111" href="/articles/278#a111">111</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph111"  >

                        <div class="parmainpart"  >

            <p class="body">В примере демонстрируется постоянная запись в буфер длительностью 20&nbsp;секунд в течение 100&nbsp;секунд, причем только последние 10&nbsp;секунд будут сохранены в файл:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph112" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a112" href="/articles/278#a112">112</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph112"  >

                        <div class="parmainpart"  >

<div lang="py"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span><br/>
<span class="linenum">2</span><br/>
<span class="linenum">3</span><br/>
<span class="linenum">4</span><br/>
<span class="linenum">5</span><br/>
<span class="linenum">6</span><br/>
<span class="linenum">7</span><br/>
<span class="linenum">8</span><br/>
<span class="linenum">9</span><br/>
<span class="linenum">10</span><br/>
<span class="linenum">11</span><br/>
<span class="linenum">12</span><br/>
<span class="linenum">13</span><br/>
<span class="linenum">14</span><br/>
<span class="linenum">15</span><br/>
<span class="linenum">16</span><br/>
<span class="linenum">17</span><br/>
<span class="linenum">18</span><br/>
<span class="linenum">19</span><br/>
<span class="linenum">20</span><br/>
<span class="linenum">21</span><br/>
<span class="linenum">22</span><br/>
<span class="linenum">23</span><br/>
<span class="linenum">24</span><br/>
<span class="linenum">25</span><br/>
<span class="linenum">26</span><br/>
<span class="linenum">27</span><br/>
<span class="linenum">28</span><br/>
<span class="linenum">29</span><br/>
<span class="linenum">30</span><br/>
<span class="linenum">31</span><br/>
<span class="linenum">32</span><br/>
<span class="linenum">33</span><br/>
<span class="linenum">34</span><br/>
<span class="linenum">35</span><br/>
<span class="linenum">36</span><br/>
<span class="linenum">37</span><br/>
<span class="linenum">38</span><br/>
<span class="linenum">39</span><br/>
<span class="linenum">40</span><br/>
<span class="linenum">41</span><br/>
<span class="linenum">42</span><br/>
<span class="linenum">43</span><br/>
<span class="linenum">44</span><br/>
<span class="linenum">45</span><br/>
<span class="linenum">46</span><br/>
<span class="linenum">47</span><br/>
<span class="linenum">48</span></div><div class="codecontainer"><span class="keywords">import</span> RPi.GPIO <span class="keywords">as</span> GPIO                             <span class="comments"># Импортируем библиотеку по работе с GPIO</span>
<span class="keywords">import</span> sys, traceback                               <span class="comments"># Импортируем библиотеки для обработки исключений</span>

<span class="keywords">import</span> picamera                                     <span class="comments"># Импортируем библиотеку по работе с камерой</span>
<span class="keywords">import</span> datetime <span class="keywords">as</span> dt                               <span class="comments"># Импортируем библиотеку для работы с датой/временем</span>
<span class="keywords">from</span> time <span class="keywords">import</span> sleep                              <span class="comments"># Импортируем функцию для работы с паузами</span>

<span class="keywords">try</span>:
    camera = picamera.PiCamera()                                        <span class="comments"># Создаем экземпляр класса для работы с камерой</span>
    camera.rotation=180

    stream = picamera.PiCameraCircularIO(camera, seconds=20)            <span class="comments"># Создаем буфер размером в 20 секунд</span>

    camera.annotate_text_size = 100                                     <span class="comments"># Размер текста из диапазона 6...160, по-умолчанию 32</span>
    <span class="comments">#camera.annotate_foreground = picamera.Color(y=1, u=0, v=0)          </span>
    camera.annotate_background = picamera.Color(<span class="strings">'black'</span>)                <span class="comments"># На черном фоне</span>

    camera.start_recording(stream, <span class="functions">format</span>=<span class="strings">'h264'</span>)                       <span class="comments"># Начинаем запись в буфер</span>
    i=0
    <span class="keywords">while</span> (i&lt;100):
        annotate_text = <span class="strings">""</span>
        <span class="keywords">if</span> (i&lt;95):
            camera.annotate_text = <span class="strings">"Before event ("</span> + <span class="functions">str</span>(i) + <span class="strings">") - "</span>  <span class="comments"># Маркируем время до наступления события</span>
        <span class="keywords">else</span>:
            camera.annotate_text = <span class="strings">"After event ("</span> + <span class="functions">str</span>(i) + <span class="strings">") - "</span>   <span class="comments"># Маркируем время после наступления события</span>

        camera.annotate_text = annotate_text + dt.datetime.now().strftime(<span class="strings">'%Y-%m-%d %H:%M:%S'</span>)  <span class="comments"># Добавляем дату/время</span>
        camera.wait_recording(1)                                        <span class="comments"># Ждем секунду</span>
        i+=1                                                                      
        <span class="functions">print</span>(i)                                                        <span class="comments"># Выводим состояние в оболочку Shell</span>
    camera.stop_recording()                                             <span class="comments"># Останавливаем запись</span>

    stream.copy_to(<span class="strings">"/home/pi/stream.h264"</span>, seconds=10)                  <span class="comments"># Сохраняем последние 10 секунд из буфера в файл</span>

<span class="keywords">except</span> KeyboardInterrupt:
    <span class="comments"># ...</span>
    <span class="functions">print</span>(<span class="strings">"Exit pressed Ctrl+C"</span>)                                        <span class="comments"># Выход из программы по нажатию Ctrl+C</span>
<span class="keywords">except</span>:
    <span class="comments"># ...</span>
    <span class="functions">print</span>(<span class="strings">"Other Exception"</span>)                                            <span class="comments"># Прочие исключения</span>
    <span class="functions">print</span>(<span class="strings">"--- Start Exception Data:"</span>)
    traceback.print_exc(limit=2, file=sys.stdout)                       <span class="comments"># Подробности исключения через traceback</span>
    <span class="functions">print</span>(<span class="strings">"--- End Exception Data:"</span>)
<span class="keywords">finally</span>:
    camera.close()                                                      <span class="comments"># Завершаем работу с экзепляром класса камеры</span>
    <span class="functions">print</span>(<span class="strings">"CleanUp"</span>)                                                    <span class="comments"># Информируем сбросе пинов</span>
    GPIO.cleanup()                                                      <span class="comments"># Возвращаем пины в исходное состояние</span>
    <span class="functions">print</span>(<span class="strings">"End of program"</span>)                                             <span class="comments"># Информируем о завершении работы программы</span></div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                <a id="0d3e7ccf-2977-437e-b561-6298878d1f8b" filename="camera_012_buffer.py" class="file" imgid="0d3e7ccf-2977-437e-b561-6298878d1f8b" href="/file/download/0d3e7ccf-2977-437e-b561-6298878d1f8b">camera_012_ buffer.py</a>&nbsp;<span class="filesize">(3,58 KB)</span>
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph113" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a113" href="/articles/278#a113">113</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph113"  >

                        <div class="parmainpart"  >

            <p class="body">Далее в статье будет приведен пример системы безопасности с записью 15-секундного видео<span class="sbrace"> </span><span class="hbrace">(</span>5&nbsp;секунд до наступления события и 10&nbsp;секунд после&#41;.
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph114" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a114" href="/articles/278#a114">114</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph114"  >

                        <div class="parmainpart"  >

    <p class="body sh">Пример использования камеры Raspberry Pi 3&nbsp;в системах безопасности.</p>
            <p class="body">Поскольку, тема детектирования движения и распознавания образов программным способом, будет затронута в следующих статьях, в данном примере о наступлении события движения будет сообщать датчик движения.
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                <table authorhas="false" excludefields="links,description" emptycolumn="false" class="products" style="display:inline-block;">


<tr style="visibility:hidden;">
    <td class="product" id="product375">
        <div class="buttons">
            <a href="/products/375"><img alt="Постоянная ссылка" title="Постоянная ссылка" src="/Content/icons/link.png" /></a>
            
        </div>

                <h4 id="product375" productid="375"><a href="/products/375">Датчик движения HC-SR501 (пироэлектрический, инфракрасный)</a></h4><a name="p375"></a>
        
         <div style="text-align:center;">
                 <div class="thumb" style="position:relative;">
                     <img id="04213456-f20e-454f-a60f-edbbc941d8a1" class="lazy fresco" alt="Датчик движения HC-SR501 (пироэлектрический, инфракрасный)" title="Датчик движения HC-SR501 (пироэлектрический, инфракрасный)" data-fresco-caption="Датчик движения HC-SR501 (пироэлектрический, инфракрасный)" style="display:inline-block;"
                          data-fresco-group="article" data-original="/file/getimage/04213456-f20e-454f-a60f-edbbc941d8a1" />
                     </div>
         </div>











    </td>

</tr>

</table>
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph115" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a115" href="/articles/278#a115">115</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph115"  >

                        <div class="parmainpart"  >

<div style="padding:.5em 1em .8em; font-size:1.1em; background-color:rgb(240,240,240); font-style:italic;">Подробно о <b>модуле HC-SR501</b>, его устройстве, принципе работы и вариантах использования можно почитать в статье&nbsp;— Инфракрасный датчик движения HC-SR501: использование с Arduino и Raspberry Pi 3.</div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph116" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a116" href="/articles/278#a116">116</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph116"  >

                        <div class="parmainpart"  >

            <p class="body">В качестве датчика движения будет использоваться <a id="375" class="codius" href="/products/375">пьезоэлектрический инфракрасный датчик движения HC-SR501</a>. Преимущество его использования заключается в том, что напряжение его питания должно быть в диапазоне 5-20&nbsp;В, а уровень логической единицы на выходе равен 3,3&nbsp;В. Эти параметры позволяют подключать датчик HC-SR501&nbsp;напрямую к Raspberry Pi 3&nbsp;без конвертеров питания и логических уровней.
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph117" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a117" href="/articles/278#a117">117</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph117"  >

                        <div class="parmainpart"  >

<img id="957c3066-f41a-42ec-bf83-5826a09c652c" class="lazy fresco imgnodescr" data-fresco-group="article" alt data-original="/file/getimage/957c3066-f41a-42ec-bf83-5826a09c652c"/>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph118" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a118" href="/articles/278#a118">118</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph118"  >

                        <div class="parmainpart"  >

            <p class="body">Суть системы безопасности заключается в следующем&nbsp;— при детектировании датчиком движения в зоне действия, камера будет делать фото и отправлять его на заданный адрес электронной почты. Светодиод в схеме дублирует состояние датчика&nbsp;— загорается в моменты срабатывания и гаснет, когда датчик отключается.
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph119" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a119" href="/articles/278#a119">119</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph119"  >

                        <div class="parmainpart"  >

            <p class="body">Схема подключения<span class="sbrace"> </span><span class="hbrace">(</span>принципиальная и наглядная&#41;:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="custom">
        <table  id="paragraph120" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">


                <td >

        <div class="notvisible">
            <div class="pnum">
                <a name="a120" href="#120">120</a>
            </div>
        </div>



                    <div id="divparagraph120"  >

                        <div class="parmainpart"  >

<div style="text-align:center; margin-top:-3em;">
<table class="innerdata" style="display:inline-block;margin: 0 1em;"><tr>
<td style="vertical-align: middle;"><img style="margin-right:4em; max-height:450px;" id="e46d5386-d152-4ebf-9891-4f8ee5cf4299" class="lazy fresco imgnodescr" data-fresco-group="article" alt data-original="/file/getimage/e46d5386-d152-4ebf-9891-4f8ee5cf4299"/></td>
<td><img id="26263393-4896-4084-ad9b-dbc68ac2b0e6" class="lazy fresco imgnodescr" data-fresco-group="article" alt data-original="/file/getimage/26263393-4896-4084-ad9b-dbc68ac2b0e6"/></td>
</tr>
<tr><td colspan="2" class="italic">Слева&nbsp;— принципиальная схема, справа&nbsp;— наглядная<span class="sbrace"> </span><span class="hbrace">(</span>номинал резистора R1&nbsp;— 220&nbsp;Ом&#41;</td></tr>
</table>
</div>


                        </div>
                    </div>

                </td>





            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph121" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a121" href="/articles/278#a121">121</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph121"  >

                        <div class="parmainpart"  >

<img id="21ba4859-71ab-4665-a11d-0b430154dd76" class="lazy fresco imgnodescr" data-fresco-group="article" alt data-original="/file/getimage/21ba4859-71ab-4665-a11d-0b430154dd76"/>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph122" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a122" href="/articles/278#a122">122</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph122"  >

                        <div class="parmainpart"  >

            <p class="body">В скетче, для отслеживания срабатывания датчика, используются <a id="254" class="codius" href="/articles/254">прерывания, реализованные в библиотеке RPi.GPIO</a>. Также использованы материалы <a id="280" class="codius" href="/articles/280">статьи об отправке электронной почты с вложениями на языке Python</a>.
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph123" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a123" href="/articles/278#a123">123</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph123"  >

                        <div class="parmainpart"  >

            <p class="body">Скетч:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph124" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a124" href="/articles/278#a124">124</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph124"  >

                        <div class="parmainpart"  >

<div lang="py"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span><br/>
<span class="linenum">2</span><br/>
<span class="linenum">3</span><br/>
<span class="linenum">4</span><br/>
<span class="linenum">5</span><br/>
<span class="linenum">6</span><br/>
<span class="linenum">7</span><br/>
<span class="linenum">8</span><br/>
<span class="linenum">9</span><br/>
<span class="linenum">10</span><br/>
<span class="linenum">11</span><br/>
<span class="linenum">12</span><br/>
<span class="linenum">13</span><br/>
<span class="linenum">14</span><br/>
<span class="linenum">15</span><br/>
<span class="linenum">16</span><br/>
<span class="linenum">17</span><br/>
<span class="linenum">18</span><br/>
<span class="linenum">19</span><br/>
<span class="linenum">20</span><br/>
<span class="linenum">21</span><br/>
<span class="linenum">22</span><br/>
<span class="linenum">23</span><br/>
<span class="linenum">24</span><br/>
<span class="linenum">25</span><br/>
<span class="linenum">26</span><br/>
<span class="linenum">27</span><br/>
<span class="linenum">28</span><br/>
<span class="linenum">29</span><br/>
<span class="linenum">30</span><br/>
<span class="linenum">31</span><br/>
<span class="linenum">32</span><br/>
<span class="linenum">33</span><br/>
<span class="linenum">34</span><br/>
<span class="linenum">35</span><br/>
<span class="linenum">36</span><br/>
<span class="linenum">37</span><br/>
<span class="linenum">38</span><br/>
<span class="linenum">39</span><br/>
<span class="linenum">40</span><br/>
<span class="linenum">41</span><br/>
<span class="linenum">42</span><br/>
<span class="linenum">43</span><br/>
<span class="linenum">44</span><br/>
<span class="linenum">45</span><br/>
<span class="linenum">46</span><br/>
<span class="linenum">47</span><br/>
<span class="linenum">48</span><br/>
<span class="linenum">49</span><br/>
<span class="linenum">50</span><br/>
<span class="linenum">51</span><br/>
<span class="linenum">52</span><br/>
<span class="linenum">53</span><br/>
<span class="linenum">54</span><br/>
<span class="linenum">55</span><br/>
<span class="linenum">56</span><br/>
<span class="linenum">57</span><br/>
<span class="linenum">58</span><br/>
<span class="linenum">59</span><br/>
<span class="linenum">60</span><br/>
<span class="linenum">61</span><br/>
<span class="linenum">62</span><br/>
<span class="linenum">63</span><br/>
<span class="linenum">64</span><br/>
<span class="linenum">65</span><br/>
<span class="linenum">66</span><br/>
<span class="linenum">67</span><br/>
<span class="linenum">68</span><br/>
<span class="linenum">69</span><br/>
<span class="linenum">70</span><br/>
<span class="linenum">71</span><br/>
<span class="linenum">72</span><br/>
<span class="linenum">73</span><br/>
<span class="linenum">74</span><br/>
<span class="linenum">75</span><br/>
<span class="linenum">76</span><br/>
<span class="linenum">77</span><br/>
<span class="linenum">78</span><br/>
<span class="linenum">79</span><br/>
<span class="linenum">80</span><br/>
<span class="linenum">81</span><br/>
<span class="linenum">82</span><br/>
<span class="linenum">83</span><br/>
<span class="linenum">84</span><br/>
<span class="linenum">85</span><br/>
<span class="linenum">86</span><br/>
<span class="linenum">87</span><br/>
<span class="linenum">88</span><br/>
<span class="linenum">89</span><br/>
<span class="linenum">90</span><br/>
<span class="linenum">91</span><br/>
<span class="linenum">92</span><br/>
<span class="linenum">93</span><br/>
<span class="linenum">94</span><br/>
<span class="linenum">95</span><br/>
<span class="linenum">96</span><br/>
<span class="linenum">97</span><br/>
<span class="linenum">98</span><br/>
<span class="linenum">99</span><br/>
<span class="linenum">100</span><br/>
<span class="linenum">101</span><br/>
<span class="linenum">102</span><br/>
<span class="linenum">103</span><br/>
<span class="linenum">104</span><br/>
<span class="linenum">105</span><br/>
<span class="linenum">106</span><br/>
<span class="linenum">107</span><br/>
<span class="linenum">108</span><br/>
<span class="linenum">109</span><br/>
<span class="linenum">110</span><br/>
<span class="linenum">111</span><br/>
<span class="linenum">112</span><br/>
<span class="linenum">113</span><br/>
<span class="linenum">114</span><br/>
<span class="linenum">115</span><br/>
<span class="linenum">116</span><br/>
<span class="linenum">117</span><br/>
<span class="linenum">118</span><br/>
<span class="linenum">119</span><br/>
<span class="linenum">120</span><br/>
<span class="linenum">121</span><br/>
<span class="linenum">122</span><br/>
<span class="linenum">123</span><br/>
<span class="linenum">124</span><br/>
<span class="linenum">125</span><br/>
<span class="linenum">126</span><br/>
<span class="linenum">127</span><br/>
<span class="linenum">128</span><br/>
<span class="linenum">129</span><br/>
<span class="linenum">130</span><br/>
<span class="linenum">131</span><br/>
<span class="linenum">132</span><br/>
<span class="linenum">133</span><br/>
<span class="linenum">134</span><br/>
<span class="linenum">135</span><br/>
<span class="linenum">136</span><br/>
<span class="linenum">137</span><br/>
<span class="linenum">138</span><br/>
<span class="linenum">139</span><br/>
<span class="linenum">140</span><br/>
<span class="linenum">141</span><br/>
<span class="linenum">142</span><br/>
<span class="linenum">143</span><br/>
<span class="linenum">144</span><br/>
<span class="linenum">145</span><br/>
<span class="linenum">146</span><br/>
<span class="linenum">147</span></div><div class="codecontainer"><span class="keywords">import</span> RPi.GPIO <span class="keywords">as</span> GPIO                             <span class="comments"># Импортируем библиотеку по работе с GPIO</span>
<span class="keywords">import</span> sys, traceback                               <span class="comments"># Импортируем библиотеки для обработки исключений</span>

<span class="keywords">import</span> picamera                                     <span class="comments"># Импортируем библиотеку по работе с камерой</span>
<span class="keywords">import</span> datetime <span class="keywords">as</span> dt                               <span class="comments"># Импортируем библиотеку для работы с датой/временем</span>
<span class="keywords">from</span>   datetime <span class="keywords">import</span> timedelta
<span class="keywords">from</span>   time <span class="keywords">import</span> sleep                            <span class="comments"># Импортируем функцию для работы с паузами</span>

<span class="comments"># Импорт библиотек, модулей и классов для работы с почтой ========================================================================================================</span>
<span class="keywords">import</span> smtplib                                      <span class="comments"># Импортируем библиотеку по работе с SMTP</span>
<span class="keywords">import</span> os                                           <span class="comments"># Функции для работы с операционной системой, не зависящие от используемой операционной системы</span>
<span class="comments"># Добавляем необходимые подклассы - MIME-типы</span>
<span class="keywords">import</span> mimetypes                                    <span class="comments"># Импорт класса для обработки неизвестных MIME-типов, базирующихся на расширении файла</span>
<span class="keywords">from</span> email <span class="keywords">import</span> encoders                          <span class="comments"># Импортируем энкодер</span>
<span class="keywords">from</span> email.mime.base <span class="keywords">import</span> MIMEBase                <span class="comments"># Общий тип</span>
<span class="keywords">from</span> email.mime.text <span class="keywords">import</span> MIMEText                <span class="comments"># Текст/HTML</span>
<span class="keywords">from</span> email.mime.image <span class="keywords">import</span> MIMEImage              <span class="comments"># Изображения</span>
<span class="keywords">from</span> email.mime.audio <span class="keywords">import</span> MIMEAudio              <span class="comments"># Аудио</span>
<span class="keywords">from</span> email.mime.multipart <span class="keywords">import</span> MIMEMultipart      <span class="comments"># Многокомпонентный объект</span>

periodBetweenEvents = 60                            <span class="comments"># Минимальный период между отправками фото</span>

<span class="keywords">try</span>:
    flagBusy = <span class="keywords">False</span>                                                                    <span class="comments"># Флаг занятости - для контроля завершенности предыдущего вызова</span>
    <span class="comments"># Переменная, предохраняющая от слишком частого срабатывания события и отправки фото</span>
    lastAction = dt.datetime.now()                                                      
    lastAction = lastAction - timedelta(seconds=(periodBetweenEvents-20))               <span class="comments"># Даем 20 секунд на калибровку датчика движения</span>

<span class="comments"># Функция-обработчик срабатывания датчика движения ===============================================================================================================</span>
    <span class="keywords">def</span> <span class="userfunctions">detect_motion</span>(pin):                                                             <span class="comments"># Объявляем функцию-обработчик callback_func1</span>
        <span class="keywords">global</span> flagBusy                                                                 <span class="comments"># Даем понять функции, что переменная не локальная, а глобальная</span>
        <span class="keywords">global</span> camera                                                                   <span class="comments"># Даем понять функции, что переменная не локальная, а глобальная</span>
        <span class="keywords">global</span> lastAction                                                               <span class="comments"># Даем понять функции, что переменная не локальная, а глобальная</span>
        <span class="functions">print</span>(<span class="strings">"Состояние пина "</span> + <span class="functions">str</span>(pin) + <span class="strings">" изменилось "</span> + <span class="functions">str</span>(GPIO.<span class="functions">input</span>(pin)))
        GPIO.output(pinLED, GPIO.<span class="functions">input</span>(pin))                                            <span class="comments"># Устанавливаем состояние светодиода в соответствии с состоянием датчика</span>
        <span class="functions">print</span>((dt.datetime.now()-lastAction).seconds)
        <span class="keywords">if</span> <span class="keywords">not</span> flagBusy <span class="keywords">and</span> ((dt.datetime.now()-lastAction).seconds &gt; periodBetweenEvents): <span class="comments"># Если флаг занятости установлен или не прошло 30 секунд пропускаем итерацию</span>
            flagBusy=<span class="keywords">True</span>                                                               <span class="comments"># Устанавливаем флаг занятости, чтобы дать процессу завершиться</span>
            <span class="keywords">if</span> GPIO.<span class="functions">input</span>(pin):                                                         <span class="comments"># Если наступление события (0-&gt;1), то делаем кадр</span>
                <span class="functions">print</span>(<span class="strings">"Отправляю фото..."</span>)
                sleep(2)                                                                <span class="comments"># Пауза нужна, чтобы объект успел попасть в кадр до момента съемки</span>
                <span class="comments"># Сначала задаем параметры накладываемого поверх текста - дата/время кадра</span>
                camera.annotate_text = dt.datetime.now().strftime(<span class="strings">'%Y-%m-%d %H:%M:%S'</span>)  <span class="comments"># Выводим дату/время</span>
                camera.annotate_text_size = 50                                          <span class="comments"># Размер текста из диапазона 6...160, по-умолчанию 32</span>
                camera.annotate_foreground = picamera.Color(y=1.0, u=0.0, v=0.0)        <span class="comments"># Цвет текста - белый</span>
                camera.annotate_background = picamera.Color(<span class="strings">'black'</span>)                    <span class="comments"># На черном фоне</span>
                camera.capture(<span class="strings">'/home/pi/image.jpg'</span>)                                    <span class="comments"># Осуществляем захват изображения</span>

                send_email(<span class="strings">"mymail@mail.ru"</span>,                                            <span class="comments"># Когда кадр сделан, его нужно отправить на электронку</span>
                           <span class="strings">"Обнаружено движение"</span>,                                       <span class="comments"># Тема</span>
                           <span class="strings">"Внимание! Устройством безопасности обнаружено движение. Фото во вложении."</span>, <span class="comments"># Текст сообшения</span>
                           [<span class="strings">"/home/pi/image.jpg"</span>])                                      <span class="comments"># Список файлов</span>
                <span class="functions">print</span>(<span class="strings">"Фото отправлено"</span>)
                
                lastAction = dt.datetime.now()                                          <span class="comments"># Дата/время последнего снимка</span>
            flagBusy=<span class="keywords">False</span>                                                              <span class="comments"># Возвращаем флаг, чтобы при следующем срабатывании функция была исполнена</span>

<span class="comments"># Функции по отправке электронной почты с вложением ==============================================================================================================</span>
    <span class="keywords">def</span> <span class="userfunctions">send_email</span>(addr_to, msg_subj, msg_text, files):
        <span class="comments"># Здесь задаются идентификационные данные учетной записи - логин, пароль =================================================================================</span>
        addr_from = <span class="strings">"my_addr@server.ru"</span>                         <span class="comments"># Отправитель, как правило совпадает с полем логин</span>
        password  = <span class="strings">"password"</span>                                  <span class="comments"># Пароль</span>
        <span class="comments"># ========================================================================================================================================================</span>

        msg = MIMEMultipart()                                   <span class="comments"># Создаем сообщение</span>
        msg[<span class="strings">'From'</span>]    = addr_from                              <span class="comments"># Адресат</span>
        msg[<span class="strings">'To'</span>]      = addr_to                                <span class="comments"># Получатель</span>
        msg[<span class="strings">'Subject'</span>] = msg_subj                               <span class="comments"># Тема сообщения</span>

        body = msg_text                                         <span class="comments"># Текст сообщения</span>
        msg.attach(MIMEText(body, <span class="strings">'plain'</span>))                     <span class="comments"># Добавляем в сообщение текст</span>

        process_attachement(msg, files)

        <span class="comments"># Этот блок настраивается для каждого почтового провайдера отдельно, подробно - <a href="http://codius.ru/articles/280">http://codius.ru/articles/280</a> ============================================</span>
        <span class="comments"># Например, для yandex настройки будут следующими:</span>
        server = smtplib.SMTP_SSL(<span class="strings">'smtp.yandex.ru'</span>, 465)        <span class="comments"># Создаем объект SMTP</span>

        <span class="comments">#server = smtplib.SMTP_SSL('smtp.server.ru', 465)        # Создаем объект SMTP</span>
        <span class="comments">#server.starttls()                                      # Начинаем шифрованный обмен по TLS</span>
        <span class="comments">#server.set_debuglevel(True)                            # Включаем режим отладки, если не нужен - можно закомментировать</span>

        server.login(addr_from, password)                       <span class="comments"># Получаем доступ</span>
        server.send_message(msg)                                <span class="comments"># Отправляем сообщение</span>
        server.quit()                                           <span class="comments"># Выходим</span>
        <span class="comments"># ========================================================================================================================================================</span>

    <span class="keywords">def</span> <span class="userfunctions">process_attachement</span>(msg, files):                        <span class="comments"># Функция по обработке списка, добавляемых к сообщению файлов</span>
        <span class="keywords">for</span> f <span class="keywords">in</span> files:
            <span class="keywords">if</span> os.path.isfile(f):                               <span class="comments"># Если файл существует</span>
                attach_file(msg,f)                              <span class="comments"># Добавляем файл к сообщению</span>
            <span class="keywords">elif</span> os.path.exists(f):                             <span class="comments"># Если путь не файл и существует, значит - папка</span>
                <span class="functions">dir</span> = os.listdir(f)                             <span class="comments"># Получаем список файлов в папке</span>
                <span class="keywords">for</span> file <span class="keywords">in</span> <span class="functions">dir</span>:                                <span class="comments"># Перебираем все файлы и...</span>
                    attach_file(msg,f+<span class="strings">"/"</span>+file)                 <span class="comments"># ...добавляем каждый файл к сообщению</span>

    <span class="keywords">def</span> <span class="userfunctions">attach_file</span>(msg, filepath):                             <span class="comments"># Функция по добавлению конкретного файла к сообщению</span>
        filename = os.path.basename(filepath)                   <span class="comments"># Получаем только имя файла</span>
        ctype, encoding = mimetypes.guess_type(filepath)        <span class="comments"># Определяем тип файла на основе его расширения</span>
        <span class="keywords">if</span> ctype <span class="keywords">is</span> <span class="keywords">None</span> <span class="keywords">or</span> encoding <span class="keywords">is</span> <span class="keywords">not</span> <span class="keywords">None</span>:               <span class="comments"># Если тип файла не определяется</span>
            ctype = <span class="strings">'application/octet-stream'</span>                  <span class="comments"># Будем использовать общий тип</span>
        maintype, subtype = ctype.split(<span class="strings">'/'</span>, 1)                 <span class="comments"># Получаем тип и подтип</span>
        <span class="keywords">if</span> maintype == <span class="strings">'image'</span>:                                 <span class="comments"># Если изображение</span>
            <span class="keywords">with</span> <span class="functions">open</span>(filepath, <span class="strings">'rb'</span>) <span class="keywords">as</span> fp:                    <span class="comments"># Открываем файл для чтения</span>
                file = MIMEImage(fp.read(), _subtype=subtype)   <span class="comments"># Используем тип MIMEImage</span>
                fp.close()                                      <span class="comments"># После использования файл обязательно нужно закрыть</span>
        <span class="keywords">else</span>:                                                   <span class="comments"># Неизвестный тип файла</span>
            <span class="keywords">with</span> <span class="functions">open</span>(filepath, <span class="strings">'rb'</span>) <span class="keywords">as</span> fp:
                file = MIMEBase(maintype, subtype)              <span class="comments"># Используем общий MIME-тип</span>
                file.set_payload(fp.read())                     <span class="comments"># Добавляем содержимое общего типа (полезную нагрузку)</span>
                fp.close()
                encoders.encode_base64(file)                    <span class="comments"># Содержимое должно кодироваться как Base64</span>
        file.add_header(<span class="strings">'Content-Disposition'</span>, <span class="strings">'attachment'</span>, filename=filename) <span class="comments"># Добавляем заголовки</span>
        msg.attach(file)                                        <span class="comments"># Добавляем файл к отправляемому сообщению</span>


<span class="comments"># Основной код программы =========================================================================================================================================</span>
    camera = picamera.PiCamera()                                        <span class="comments"># Создаем экземпляр класса для работы с камерой</span>
    camera.rotation=180
    
    <span class="comments"># Инициализация пинов</span>
    GPIO.setmode(GPIO.BCM)

    pinLED=24                                                           <span class="comments"># Пин светодиода</span>
    pinSensor=15                                                        <span class="comments"># Пин датчика</span>
    GPIO.setup(pinLED, GPIO.OUT, initial=0)                             <span class="comments"># Пин светодиода в режим OUTPUT</span>
    GPIO.setup(pinSensor, GPIO.IN)                                      <span class="comments"># Сигнальный пин сенсора в режим INPUT, без подтяжки</span>

    GPIO.add_event_detect(pinSensor, GPIO.BOTH, callback=detect_motion) <span class="comments"># Назначаем функцию-обработчик (detect_motion) на детектирование события (изменение сигнала - и по фронту и по спаду)</span>

    <span class="keywords">while</span> 1:
        sleep(1)                                                       <span class="comments"># Бесконечный цикл с итерацией раз в 10 секунд</span>

<span class="keywords">except</span> KeyboardInterrupt:
    <span class="comments"># ...</span>
    <span class="functions">print</span>(<span class="strings">"Exit pressed Ctrl+C"</span>)                                        <span class="comments"># Выход из программы по нажатию Ctrl+C</span>
<span class="keywords">except</span>:
    <span class="comments"># ...</span>
    <span class="functions">print</span>(<span class="strings">"Other Exception"</span>)                                            <span class="comments"># Прочие исключения</span>
    <span class="functions">print</span>(<span class="strings">"--- Start Exception Data:"</span>)
    traceback.print_exc(limit=2, file=sys.stdout)                       <span class="comments"># Подробности исключения через traceback</span>
    <span class="functions">print</span>(<span class="strings">"--- End Exception Data:"</span>)
<span class="keywords">finally</span>:
    camera.close()                                                      <span class="comments"># Завершаем работу с экзепляром класса камеры</span>
    <span class="functions">print</span>(<span class="strings">"CleanUp"</span>)                                                    <span class="comments"># Информируем сбросе пинов</span>
    GPIO.cleanup()                                                      <span class="comments"># Возвращаем пины в исходное состояние</span>
    <span class="functions">print</span>(<span class="strings">"End of program"</span>)                                             <span class="comments"># Информируем о завершении работы программы</span></div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                <a id="b0d29253-fdf0-4172-befc-3967069db486" filename="camera_013_security_sendphoto.py" class="file" imgid="b0d29253-fdf0-4172-befc-3967069db486" href="/file/download/b0d29253-fdf0-4172-befc-3967069db486">camera_013_ security_ sendphoto.py</a>&nbsp;<span class="filesize">(15,0 KB)</span>
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph125" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a125" href="/articles/278#a125">125</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph125"  >

                        <div class="parmainpart"  >

            <p class="body">От частого срабатывания датчика движения, пример дополнен программным<span class="slaquo"> </span><span class="hlaquo">«</span>предохранителем» — переменная <span class="mono">periodBetweenEvents</span> — он не позволяет делать и отправлять фото чаще чем раз в 6- секунд.
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph126" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a126" href="/articles/278#a126">126</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph126"  >

                        <div class="parmainpart"  >

<img id="cee47235-7871-4156-bc93-0a1ca7bd7a59" class="lazy fresco" data-fresco-group="article" alt="Письмо системы безопасности с фото" data-original="/file/getimage/cee47235-7871-4156-bc93-0a1ca7bd7a59" data-fresco-caption="Письмо системы безопасности с фото" title="Письмо системы безопасности с фото"/><div class="imgdescr">Письмо системы безопасности с фото</div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph127" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a127" href="/articles/278#a127">127</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph127"  >

                        <div class="parmainpart"  >

            <p class="body">Данный пример обладает одним существенным недостатком&nbsp;— из-за разницы в углах охвата камеры и датчика движения, очень вероятны ситуации, когда снимок будет сделан до того, как нужный объект попадет в поле зрения камеры, либо уже после того, как объект из него удалится. Этот недостаток можно устранить разными способами:<ul style="margin:1em 0 -.5em 0;" class="list"><li>внедрить паузу, корректирующую время создания снимка<span class="sbrace"> </span><span class="hbrace">(</span>строка 42&nbsp;скетча&#41;;</li>
<li>расположить камеру и датчик движения так, чтобы избегать таких проблем;</li>
<li>при детектировании события начинать видеозапись заданной продолжительностью.</li>
</ul>
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph128" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a128" href="/articles/278#a128">128</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph128"  >

                        <div class="parmainpart"  >

            <p class="body">Но библиотека <b>PiCamera</b>, как уже было упомянуто выше, обладает возможностью осуществлять циклическую запись видео в буфер заданного размера. Это позволяет получить доступ к видеоданным, записанным до наступления события. В следующем примере, Малинка постоянно осуществляет запись в буфер длительностью 30&nbsp;секунд. При наступлении события, в файл записывается 5&nbsp;секунд до наступления события и 10&nbsp;секунд после его наступления. Каждое последующее событие записывается в новый файл&nbsp;— его имя формируется из номера по порядку и даты/времени наступившего события.
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph129" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a129" href="/articles/278#a129">129</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph129"  >

                        <div class="parmainpart"  >

<div lang="py"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span><br/>
<span class="linenum">2</span><br/>
<span class="linenum">3</span><br/>
<span class="linenum">4</span><br/>
<span class="linenum">5</span><br/>
<span class="linenum">6</span><br/>
<span class="linenum">7</span><br/>
<span class="linenum">8</span><br/>
<span class="linenum">9</span><br/>
<span class="linenum">10</span><br/>
<span class="linenum">11</span><br/>
<span class="linenum">12</span><br/>
<span class="linenum">13</span><br/>
<span class="linenum">14</span><br/>
<span class="linenum">15</span><br/>
<span class="linenum">16</span><br/>
<span class="linenum">17</span><br/>
<span class="linenum">18</span><br/>
<span class="linenum">19</span><br/>
<span class="linenum">20</span><br/>
<span class="linenum">21</span><br/>
<span class="linenum">22</span><br/>
<span class="linenum">23</span><br/>
<span class="linenum">24</span><br/>
<span class="linenum">25</span><br/>
<span class="linenum">26</span><br/>
<span class="linenum">27</span><br/>
<span class="linenum">28</span><br/>
<span class="linenum">29</span><br/>
<span class="linenum">30</span><br/>
<span class="linenum">31</span><br/>
<span class="linenum">32</span><br/>
<span class="linenum">33</span><br/>
<span class="linenum">34</span><br/>
<span class="linenum">35</span><br/>
<span class="linenum">36</span><br/>
<span class="linenum">37</span><br/>
<span class="linenum">38</span><br/>
<span class="linenum">39</span><br/>
<span class="linenum">40</span><br/>
<span class="linenum">41</span><br/>
<span class="linenum">42</span><br/>
<span class="linenum">43</span><br/>
<span class="linenum">44</span><br/>
<span class="linenum">45</span><br/>
<span class="linenum">46</span><br/>
<span class="linenum">47</span><br/>
<span class="linenum">48</span><br/>
<span class="linenum">49</span><br/>
<span class="linenum">50</span><br/>
<span class="linenum">51</span><br/>
<span class="linenum">52</span><br/>
<span class="linenum">53</span><br/>
<span class="linenum">54</span><br/>
<span class="linenum">55</span><br/>
<span class="linenum">56</span><br/>
<span class="linenum">57</span><br/>
<span class="linenum">58</span><br/>
<span class="linenum">59</span><br/>
<span class="linenum">60</span><br/>
<span class="linenum">61</span><br/>
<span class="linenum">62</span><br/>
<span class="linenum">63</span><br/>
<span class="linenum">64</span><br/>
<span class="linenum">65</span><br/>
<span class="linenum">66</span><br/>
<span class="linenum">67</span><br/>
<span class="linenum">68</span><br/>
<span class="linenum">69</span><br/>
<span class="linenum">70</span><br/>
<span class="linenum">71</span><br/>
<span class="linenum">72</span><br/>
<span class="linenum">73</span><br/>
<span class="linenum">74</span><br/>
<span class="linenum">75</span><br/>
<span class="linenum">76</span><br/>
<span class="linenum">77</span><br/>
<span class="linenum">78</span><br/>
<span class="linenum">79</span><br/>
<span class="linenum">80</span><br/>
<span class="linenum">81</span><br/>
<span class="linenum">82</span><br/>
<span class="linenum">83</span><br/>
<span class="linenum">84</span><br/>
<span class="linenum">85</span><br/>
<span class="linenum">86</span><br/>
<span class="linenum">87</span><br/>
<span class="linenum">88</span><br/>
<span class="linenum">89</span><br/>
<span class="linenum">90</span><br/>
<span class="linenum">91</span><br/>
<span class="linenum">92</span><br/>
<span class="linenum">93</span><br/>
<span class="linenum">94</span></div><div class="codecontainer"><span class="keywords">import</span> RPi.GPIO <span class="keywords">as</span> GPIO                             <span class="comments"># Импортируем библиотеку по работе с GPIO</span>
<span class="keywords">import</span> sys, traceback                               <span class="comments"># Импортируем библиотеки для обработки исключений</span>

<span class="keywords">import</span> picamera                                     <span class="comments"># Импортируем библиотеку по работе с камерой</span>
<span class="keywords">import</span> datetime <span class="keywords">as</span> dt                               <span class="comments"># Импортируем библиотеку для работы с датой/временем</span>
<span class="keywords">from</span>   datetime <span class="keywords">import</span> timedelta
<span class="keywords">from</span>   time <span class="keywords">import</span> sleep                            <span class="comments"># Импортируем функцию для работы с паузами</span>

periodBetweenEvents = 60                            <span class="comments"># Минимальный период между отправками фото</span>

<span class="keywords">try</span>:
    saveEvent = <span class="keywords">False</span>                                                                   <span class="comments"># Флаг занятости - для контроля завершенности предыдущего вызова</span>
    <span class="comments"># Переменная, предохраняющая от слишком частого срабатывания события и отправки фото</span>
    lastAction = dt.datetime.now()                                                      
    lastAction = lastAction - timedelta(seconds=(periodBetweenEvents-10))               <span class="comments"># Даем 20 секунд на калибровку датчика движения</span>

    startEvent =  dt.datetime.now()

<span class="comments"># Функция-обработчик срабатывания датчика движения ===============================================================================================================</span>
    <span class="keywords">def</span> <span class="userfunctions">detect_motion</span>(pin):                                                             <span class="comments"># Объявляем функцию-обработчик callback_func1</span>
        <span class="keywords">global</span> saveEvent                                                                <span class="comments"># Даем понять функции, что переменная не локальная, а глобальная</span>
        <span class="keywords">global</span> camera                                                                   <span class="comments"># Даем понять функции, что переменная не локальная, а глобальная</span>
        <span class="keywords">global</span> lastAction                                                               <span class="comments"># Даем понять функции, что переменная не локальная, а глобальная</span>
        <span class="keywords">global</span> startEvent                                                                  <span class="comments"># Переменная номера файла</span>
        <span class="functions">print</span>(<span class="strings">"Состояние пина "</span> + <span class="functions">str</span>(pin) + <span class="strings">" изменилось "</span> + <span class="functions">str</span>(GPIO.<span class="functions">input</span>(pin)))
        GPIO.output(pinLED, GPIO.<span class="functions">input</span>(pin))                                            <span class="comments"># Устанавливаем состояние светодиода в соответствии с состоянием датчика</span>
        <span class="functions">print</span>((dt.datetime.now()-lastAction).seconds)
        <span class="keywords">if</span> <span class="keywords">not</span> saveEvent <span class="keywords">and</span> ((dt.datetime.now()-lastAction).seconds &gt; periodBetweenEvents): <span class="comments"># Если флаг занятости установлен или не прошло 30 секунд пропускаем итерацию</span>
            <span class="keywords">if</span> GPIO.<span class="functions">input</span>(pin):                                                         <span class="comments"># Если наступление события (0-&gt;1), то сохраняем видео</span>
                <span class="functions">print</span>(<span class="strings">"Продолжаем запись 10 секунд после наступления события"</span>)
                startEvent =  dt.datetime.now()                                         <span class="comments"># Запоминаем, когда наступило событие</span>
                saveEvent = <span class="keywords">True</span>                                                        <span class="comments"># Устанавливаем флаг срабатывания события</span>


<span class="comments"># Основной код программы =========================================================================================================================================</span>
    camera = picamera.PiCamera()                                        <span class="comments"># Создаем экземпляр класса для работы с камерой</span>
    camera.rotation=180                                                 <span class="comments"># Поворачиваем изображение на 180 градусов</span>
    
    <span class="comments"># Инициализация пинов</span>
    GPIO.setmode(GPIO.BCM)

    pinLED=24                                                           <span class="comments"># Пин светодиода</span>
    pinSensor=15                                                        <span class="comments"># Пин датчика</span>
    GPIO.setup(pinLED, GPIO.OUT, initial=0)                             <span class="comments"># Пин светодиода в режим OUTPUT</span>
    GPIO.setup(pinSensor, GPIO.IN)                                      <span class="comments"># Сигнальный пин сенсора в режим INPUT, без подтяжки</span>

    GPIO.add_event_detect(pinSensor, GPIO.BOTH, callback=detect_motion) <span class="comments"># Назначаем функцию-обработчик (detect_motion) на детектирование события (изменение сигнала - и по фронту и по спаду)</span>

    camera.annotate_text_size = 50                                      <span class="comments"># Размер текста из диапазона 6...160, по-умолчанию 32</span>

    stream = picamera.PiCameraCircularIO(camera, seconds=30)            <span class="comments"># Создаем буфер размером в 30 секунд</span>
    camera.start_recording(stream, <span class="functions">format</span>=<span class="strings">'h264'</span>)                       <span class="comments"># Начинаем запись в буфер</span>

    fileNum = 1                                                         <span class="comments"># Начальный номер файла</span>
    <span class="keywords">while</span> 1:                                                            <span class="comments"># Бесконечный цикл</span>
        annotate_text = <span class="strings">""</span>
        <span class="keywords">if</span> saveEvent:
            annotate_text = <span class="strings">"After event - "</span>                            <span class="comments"># Маркируем кадры после наступления события</span>
        <span class="keywords">else</span>:
            annotate_text = <span class="strings">"Before event - "</span>                           <span class="comments"># Маркируем кадры до наступления события</span>

        camera.annotate_text = annotate_text + dt.datetime.now().strftime(<span class="strings">'%Y-%m-%d %H:%M:%S'</span>)  <span class="comments"># Добавляем дату/время</span>
        <span class="keywords">if</span> saveEvent <span class="keywords">and</span> ((dt.datetime.now()-startEvent).seconds &gt; 10):
            <span class="functions">print</span>(<span class="strings">"Запись события завершена, приступаем к соранению"</span>)

            camera.stop_recording()                                     <span class="comments"># Останавливаем запись</span>
            fileName = <span class="strings">'%03d'</span> % fileNum + startEvent.strftime(<span class="strings">'_%Y_%m_%d_%H_%M_%S'</span>)+<span class="strings">'.h264'</span> <span class="comments"># Формируем имя файла</span>
            <span class="functions">print</span>(<span class="strings">'Видеозапись события будет сохранена в файл '</span>+ fileName)
            stream.copy_to(<span class="strings">"/home/pi/"</span>+fileName, seconds=15)            <span class="comments"># Сохраняем последние 10 секунд из буфера в файл</span>
            <span class="functions">print</span>(<span class="strings">'Событие сохранено'</span>)
            stream.clear()                                              <span class="comments"># Очищаем буфер</span>

            camera.start_recording(stream, <span class="functions">format</span>=<span class="strings">'h264'</span>)               <span class="comments"># Начинаем новую запись в буфер</span>
            fileNum+=1                                                  <span class="comments"># Наращиваем номер для имени файла</span>
       
            lastAction = dt.datetime.now()                              <span class="comments"># Дата/время последнего снимка</span>
            saveEvent = <span class="keywords">False</span>                                           <span class="comments"># Сбрасываем флаг записи события</span>
        <span class="keywords">else</span>:
            camera.wait_recording(0.2)                                  <span class="comments"># Ждем 0.2 секунды</span>

<span class="keywords">except</span> KeyboardInterrupt:
    <span class="comments"># ...</span>
    <span class="functions">print</span>(<span class="strings">"Exit pressed Ctrl+C"</span>)                                        <span class="comments"># Выход из программы по нажатию Ctrl+C</span>
<span class="keywords">except</span>:
    <span class="comments"># ...</span>
    <span class="functions">print</span>(<span class="strings">"Other Exception"</span>)                                            <span class="comments"># Прочие исключения</span>
    <span class="functions">print</span>(<span class="strings">"--- Start Exception Data:"</span>)
    traceback.print_exc(limit=2, file=sys.stdout)                       <span class="comments"># Подробности исключения через traceback</span>
    <span class="functions">print</span>(<span class="strings">"--- End Exception Data:"</span>)
<span class="keywords">finally</span>:
    camera.close()                                                      <span class="comments"># Завершаем работу с экзепляром класса камеры</span>
    <span class="functions">print</span>(<span class="strings">"CleanUp"</span>)                                                    <span class="comments"># Информируем сбросе пинов</span>
    GPIO.cleanup()                                                      <span class="comments"># Возвращаем пины в исходное состояние</span>
    <span class="functions">print</span>(<span class="strings">"End of program"</span>)                                             <span class="comments"># Информируем о завершении работы программы</span></div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                <a id="51afca78-e9fa-4ee6-91b8-c809ef348887" filename="camera_014_security_video.py" class="file" imgid="51afca78-e9fa-4ee6-91b8-c809ef348887" href="/file/download/51afca78-e9fa-4ee6-91b8-c809ef348887">camera_014_ security_video.py</a>&nbsp;<span class="filesize">(8,74 KB)</span>
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="custom">
        <table  id="paragraph130" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">


                <td >

        <div class="notvisible">
            <div class="pnum">
                <a name="a130" href="#130">130</a>
            </div>
        </div>



                    <div id="divparagraph130"  >

                        <div class="parmainpart"  >

<div style="margin-top:-1.5em; margin-bottom:-1em;"><div><img style="width:100%;" id="ca3d841c-efdd-485d-999d-8857cd9203ca" class="lazy fresco" data-fresco-group="article" alt="Аннотации к видео показывают момент срабатывания датчика движения&nbsp;— bBefore Event/b (до наступления события) и bAfter Event/b (после наступления события)" data-original="/file/getfullimage/ca3d841c-efdd-485d-999d-8857cd9203ca" data-fresco-caption="Аннотации к видео показывают момент срабатывания датчика движения&nbsp;— Before Event (до наступления события) и After Event (после наступления события)" title="Аннотации к видео показывают момент срабатывания датчика движения&nbsp;— Before Event (до наступления события) и After Event (после наступления события)"/><div class="imgdescr">Аннотации к видео показывают момент срабатывания датчика движения&nbsp;— <b>Before Event</b><span class="sbrace"> </span><span class="hbrace">(</span>до наступления события&#41; и <b>After Event</b><span class="sbrace"> </span><span class="hbrace">(</span>после наступления события&#41;</div></div></div>


                        </div>
                    </div>

                </td>





            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph131" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a131" href="/articles/278#a131">131</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph131"  >

                        <div class="parmainpart"  >

    <p class="body sh">Качество съемки</p>
            <p class="body">Для оценки качества съемки, прилагаются файлы записи видео в разных режимах. Видеопоток в файлах не помещен в медиаконтейнер, поэтому видео воспроизводится с частотой 30&nbsp;fps. Поместить видеопоток в медиаконтейнер можно при помощи утилиты <span class="mono">avconv</span>:<ul style="margin:1em 0 -.5em 0;" class="list"><li><a class="file" href="https://yadi.sk/d/6jqb_xZz3SZQrT">480p60fps.h264</a></li>
<li><a class="outersource" href="https://yadi.sk/d/WeYrTEdX3SZQs6">480p90fps.h264</a></li>
<li><a class="outersource" href="https://yadi.sk/d/C7BPKoUd3SZQse">720p45fps.h264</a></li>
<li><a class="outersource" href="https://yadi.sk/d/Y9-bTYyE3SZQqQ">1080p30fps.h264</a></li>
</ul>
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph132" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a132" href="/articles/278#a132">132</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph132"  >

                        <div class="parmainpart"  >

            <p class="body">Воспроизвести файлы <span class="mono">*.h264</span> на Windows-ПК можно при помощи <a class="outersource" href="https://www.videolan.org/index.ru.html">медиаплеера VLC</a>.
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-note"">
        <table class="note" id="paragraph133" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a133" href="/articles/278#a133">133</a>
    </td>
    <td class="leftpart">
        <span class="lang">На заметку:</span>
    </td>

                <td class="content">




                    <div id="divparagraph133"  >

                        <div class="parmainpart"  >

Во время съемки камера умышленно приводится в движение, для тестирования записи динамической картинки.


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph134" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a134" href="/articles/278#a134">134</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph134"  >

                        <div class="parmainpart"  >

            <p class="body">Видео записано при помощи скетча:
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art inner-code"">
        <table class="code" id="paragraph135" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a135" href="/articles/278#a135">135</a>
    </td>
    <td class="leftpart">
        <span class="lang">Python</span>
    </td>

                <td class="content">




                    <div id="divparagraph135"  >

                        <div class="parmainpart"  >

<div lang="py"><div class="code" lang="py"><div class="linenumbers"><span class="linenum">1</span><br/>
<span class="linenum">2</span><br/>
<span class="linenum">3</span><br/>
<span class="linenum">4</span><br/>
<span class="linenum">5</span><br/>
<span class="linenum">6</span><br/>
<span class="linenum">7</span><br/>
<span class="linenum">8</span><br/>
<span class="linenum">9</span><br/>
<span class="linenum">10</span><br/>
<span class="linenum">11</span><br/>
<span class="linenum">12</span><br/>
<span class="linenum">13</span><br/>
<span class="linenum">14</span><br/>
<span class="linenum">15</span><br/>
<span class="linenum">16</span><br/>
<span class="linenum">17</span><br/>
<span class="linenum">18</span><br/>
<span class="linenum">19</span><br/>
<span class="linenum">20</span><br/>
<span class="linenum">21</span><br/>
<span class="linenum">22</span><br/>
<span class="linenum">23</span><br/>
<span class="linenum">24</span><br/>
<span class="linenum">25</span><br/>
<span class="linenum">26</span><br/>
<span class="linenum">27</span><br/>
<span class="linenum">28</span><br/>
<span class="linenum">29</span><br/>
<span class="linenum">30</span><br/>
<span class="linenum">31</span><br/>
<span class="linenum">32</span><br/>
<span class="linenum">33</span><br/>
<span class="linenum">34</span><br/>
<span class="linenum">35</span><br/>
<span class="linenum">36</span><br/>
<span class="linenum">37</span><br/>
<span class="linenum">38</span><br/>
<span class="linenum">39</span><br/>
<span class="linenum">40</span><br/>
<span class="linenum">41</span><br/>
<span class="linenum">42</span><br/>
<span class="linenum">43</span><br/>
<span class="linenum">44</span></div><div class="codecontainer"><span class="keywords">import</span> RPi.GPIO <span class="keywords">as</span> GPIO                         <span class="comments"># Импортируем библиотеку по работе с GPIO</span>
<span class="keywords">import</span> picamera                                 <span class="comments"># Импортируем библиотеку PiCamera</span>
<span class="keywords">from</span>   time <span class="keywords">import</span> sleep
<span class="keywords">import</span> datetime <span class="keywords">as</span> dt

<span class="keywords">def</span> <span class="userfunctions">start_video_capture</span>(filename):
    <span class="keywords">global</span> camera

    annotate=(<span class="strings">'Resolution:'</span> + <span class="functions">str</span>(camera.resolution) +
              <span class="strings">', Framerate:'</span> + <span class="functions">str</span>(camera.framerate) +
              <span class="strings">', Sensor Mode:'</span> + <span class="functions">str</span>(camera.sensor_mode))

    camera.annotate_text = annotate                                 <span class="comments"># Выводим дату/время</span>
    camera.annotate_text_size = 20                                  <span class="comments"># Размер текста из диапазона 6...160, по-умолчанию 32</span>
    camera.annotate_foreground = picamera.Color(y=1, u=0, v=0)      <span class="comments"># Цвет текста - серый</span>
    camera.annotate_background = picamera.Color(<span class="strings">'black'</span>)            <span class="comments"># На черном фоне</span>

    camera.start_recording(<span class="strings">'/home/pi/'</span>+filename)                    <span class="comments"># Начинаем запись и сохраняем в файл</span>
    camera.wait_recording(20)                                       <span class="comments"># Записываем 1 минуту, после чего</span>
    camera.stop_recording()                                         <span class="comments"># Завершаем запись</span>

<span class="keywords">try</span>:
    <span class="comments"># Задаем параметры основных режимов</span>
    params=[
        [1, 30, (1920, 1080), <span class="strings">'1080p'</span>],
        [5, 45, (1296, 730), <span class="strings">'720p'</span>],
        [6, 60, (640, 480), <span class="strings">'480p'</span>],
        [7, 90, (640, 480), <span class="strings">'480p'</span>]
        ]

    camera = picamera.PiCamera()
    
    <span class="keywords">for</span> i <span class="keywords">in</span> <span class="functions">range</span>(0,4):
        camera.sensor_mode = params[i][0]       <span class="comments"># Задаем режим работы сенсора (<a href="https://picamera.readthedocs.io/en/release-1.13/fov.html#sensor-modes">https://picamera.readthedocs.io/en/release-1.13/fov.html#sensor-modes</a>)</span>
        <span class="functions">print</span>(camera.sensor_mode)
        camera.rotation = 180                   <span class="comments"># Разворачиваем камеру</span>
        camera.resolution = params[i][2]        <span class="comments"># Задаем разрешение</span>
        camera.framerate = params[i][1]         <span class="comments"># Задаем частоту кадров</span>
        start_video_capture(params[i][3] + <span class="functions">str</span>(camera.framerate) + <span class="strings">'fps.h264'</span>) <span class="comments"># Начинаем запись и сохраняем в файл</span>

<span class="keywords">finally</span>:
    camera.close()                              <span class="comments"># Корректно завершаем любую активность камеры</span>
    GPIO.cleanup()                              <span class="comments"># Возвращаем пины в исходное состояние</span>
    <span class="functions">print</span>(<span class="strings">"End of program"</span>)                     <span class="comments"># Информируем о завершении работы программы</span></div></div></div>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph136" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a136" href="/articles/278#a136">136</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph136"  >

                        <div class="parmainpart"  >

            <p class="body">В некоторых местах заметен значительный пропуск кадров.
             
            </p>



                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph137" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a137" href="/articles/278#a137">137</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph137"  >

                        <div class="parmainpart"  >

<p class="sh">Что почитать:</p>
<ul class="requests list"><li><a href="https://www.raspberrypi.org/products/camera-module-v2/">Camera Module v2</a></li>
<li><a href="https://www.raspberrypi.org/documentation/hardware/camera/">Сравнение оригинальных камер первого и второго поколения</a></li>
<li><a class="file" href="https://cdn.sparkfun.com/datasheets/Dev/RaspberryPi/ov5647_full.pdf">Даташит на OmniVision OV5647</a>, <a class="filename" href="http://docs-europe.electrocomponents.com/webdocs/11d1/0900766b811d1155.pdf">Product Brief на OmniVision OV5647</a></li>
<li><a href="http://www.sony-semicon.co.jp/products_en/new_pro/april_2014/imx219_e.html">Sony IMX219PQ</a></li>
<li><a href="https://www.raspberrypi.org/documentation/usage/camera/python/README.md">Python PiCamera</a></li>
<li><b><a href="https://picamera.readthedocs.io/en/release-1.13/">Python PiCamera на Read The Docs</a></b></li>
<li><b><a href="https://projects.raspberrypi.org/en/projects/getting-started-with-picamera">Getting started with picamera<span class="sbrace"> </span><span class="hbrace">(</span>Python&#41;</a></b></li>
<li><a href="http://www.autodidacts.io/convert-media-files-like-a-geek-a-guide-to-video-transcoding-with-avconv-ffmpeg/">Convert media files like a geek: a guide to video transcoding with Avconv</a></li>
<li><a href="https://techedemic.com/2014/09/18/creating-a-timelapse-clip-with-avconv/">Creating a timelapse clip with avconv</a></li>
<li><a href="http://leerspace.com/2016/01/31/creating-a-time-lapse-from-a-series-of-images-on-ubuntu-server-14-04/">Creating a time-lapse from a series of images using avconv</a></li>
<li><a href="https://libav.org/avconv.html">avconv Documentation</a></li>
</ul>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>




    <div class="inner_art">
        <table  id="paragraph138" border="0" cellpadding="0" cellspacing="0" style="width:100%">
            <tr valign="top">

    <td class="pnum">
        <a name="a138" href="/articles/278#a138">138</a>
    </td>
    <td class="leftpart">
        <span class="lang"></span>
    </td>

                <td class="content">




                    <div id="divparagraph138"  >

                        <div class="parmainpart"  >

<p class="sh">Похожие запросы:</p>
<ul class="requests list"><li>Raspberry Pi 3&nbsp;GPIO&nbsp;— камера</li>
<li>Как подключить камеру к Raspberry Pi 3</li>
<li>Как настроить камеру Raspberry Pi 3</li>
<li>Как при помощи камеры сделать timelapse-видео</li>
<li>Сшивание timelapse-видео из изображений</li>
<li>Convert media files like a geek: a guide to video transcoding with Avconv</li>
<li>Creating a timelapse clip with avconv</li>
<li>Creating a time-lapse from a series of images using avconv</li>
</ul>


                        </div>
                    </div>

                </td>

    <td class="side">
        <div style="position:relative;">
            <div style="position:absolute; width:100%; z-index:99999999">
                
            </div>
        </div>
    </td>




            </tr>
        </table>
    </div>



    <div class="inner_art">

    <table id="paragraph139" border="0" cellpadding="0" cellspacing="0" width="100%">
        <tr valign="top">
            <td class="pnum"></td>
            <td class="leftpart"></td>
            <td class="content">
                <div id="divparagraph139" class="paragraph" >
                    <div class="parmainpart" style="margin-top:2.5em;">
                        <div id="hypercomments_widget"></div>
                        <script type="text/javascript">
                            _hcwp = window._hcwp || [];
                            _hcwp.push({ widget: "Stream", widget_id: 27823 });
                            (function () {
                                if ("HC_LOAD_INIT" in window) return;
                                HC_LOAD_INIT = true;
                                var lang = (navigator.language || navigator.systemLanguage || navigator.userLanguage || "en").substr(0, 2).toLowerCase();
                                var hcc = document.createElement("script"); hcc.type = "text/javascript"; hcc.async = true;
                                hcc.src = ("https:" == document.location.protocol ? "https" : "http") + "://w.hypercomments.com/widget/hc/27823/" + lang + "/widget.js";
                                var s = document.getElementsByTagName("script")[0];
                                s.parentNode.insertBefore(hcc, s.nextSibling);
                            })();
                        </script>
                        <a href="http://hypercomments.com" class="hc-link" title="comments widget">comments powered by HyperComments</a>
                    </div>
                </div>
            </td>
            <td class="side"></td>
        </tr>
        </table>
        </div>



<br />






    <div id ="popup_promo" >
    <div id="overlay"></div>
    <div id = "popup" >
        <div id="img_promo">
            <div id="play_promo"></div>
            <div style="position:relative;">
                <div id="close_popup"></div>
            </div>
        </div>
        </div>
    </div>






        </div>
        <div id="footer-compensation"></div>
    </main>
    <footer>
        <div class="inner">
            <div id="copy">&copy; 2013-2023 codius.ru</div>
        </div>
    </footer>



    


    <script type="text/javascript" charset="utf-8">
        $(function() {
            $("img.lazy").lazyload({
                effect : "fadeIn"
            });

        });
    </script>





    </body>
    </html>




